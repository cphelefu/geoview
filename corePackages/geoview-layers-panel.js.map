{"version":3,"file":"corePackages/geoview-layers-panel.js","mappings":"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","sources":["webpack://geoview-core/../geoview-layers-panel/src/layer-stepper.tsx","webpack://geoview-core/../geoview-layers-panel/src/reorder-layers-list.tsx","webpack://geoview-core/../geoview-layers-panel/src/panel-content.tsx","webpack://geoview-core/../geoview-layers-panel/src/index.tsx"],"sourcesContent":["/* eslint-disable react/require-default-props */\nimport type React from 'react';\nimport {\n  TypeWindow,\n  TypeJsonArray,\n  TypeGeoviewLayerConfig,\n  TypeGeoviewLayerType,\n  SelectChangeEvent,\n  ButtonPropsLayerPanel,\n  TypeListOfLayerEntryConfig,\n  TypeLayerEntryConfig,\n  TypeJsonObject,\n  PayloadBaseClass,\n  payloadIsASnackbarMessage,\n} from 'geoview-core';\n\ntype Event = { target: { value: string } };\n\ninterface Props {\n  mapId: string;\n  setAddLayerVisible: (isVisible: boolean) => void;\n}\n\ntype EsriOptions = {\n  err: string;\n  capability: string;\n};\n\nconst w = window as TypeWindow;\n\n/**\n * A react component that displays the details panel content\n *\n * @returns {JSX.Element} A React JSX Element with the details panel\n */\nfunction LayerStepper({ mapId, setAddLayerVisible }: Props): JSX.Element {\n  const { cgpv } = w;\n  const { api, ui, react } = cgpv;\n  const displayLanguage = api.maps[mapId].displayLanguage as 'en' | 'fr';\n\n  const { ESRI_DYNAMIC, ESRI_FEATURE, GEOJSON, GEOPACKAGE, WMS, WFS, OGC_FEATURE, XYZ_TILES, GEOCORE } = api.layerTypes;\n  const { useState, useEffect, useRef } = react;\n  const {\n    Select,\n    Stepper,\n    TextField,\n    Button,\n    ButtonGroup,\n    Autocomplete,\n    CircularProgressBase,\n    Box,\n    IconButton,\n    CloseIcon,\n    FileUploadIcon,\n  } = ui.elements;\n\n  const [activeStep, setActiveStep] = useState(0);\n  const [layerURL, setLayerURL] = useState('');\n  const [displayURL, setDisplayURL] = useState('');\n  const [layerType, setLayerType] = useState<TypeGeoviewLayerType | ''>('');\n  const [layerList, setLayerList] = useState<TypeJsonArray[]>([]);\n  const [layerName, setLayerName] = useState('');\n  const [layerEntries, setLayerEntries] = useState<TypeListOfLayerEntryConfig>([]);\n  const [isLoading, setIsLoading] = useState<boolean>(false);\n  const [drag, setDrag] = useState<boolean>(false);\n\n  const dragPopover = useRef(null);\n\n  const sxClasses = {\n    buttonGroup: {\n      paddingTop: 12,\n      gap: 6,\n    },\n  };\n\n  const isMultiple = () => layerType === ESRI_DYNAMIC || layerType === WFS || layerType === WMS;\n\n  /**\n   * List of layer types and labels\n   */\n  const layerOptions = [\n    [ESRI_DYNAMIC, 'ESRI Dynamic Service'],\n    [ESRI_FEATURE, 'ESRI Feature Service'],\n    [GEOJSON, 'GeoJSON'],\n    [GEOPACKAGE, 'GeoPackage'],\n    [WMS, 'OGC Web Map Service (WMS)'],\n    [WFS, 'OGC Web Feature Service (WFS)'],\n    [OGC_FEATURE, 'OGC API Features'],\n    [XYZ_TILES, 'XYZ Raster Tiles'],\n    [GEOCORE, 'GeoCore'],\n  ];\n\n  /**\n   * Translations object to inject to the viewer translations\n   */\n  const translations = {\n    en: {\n      finish: 'Finish',\n      continue: 'Continue',\n      back: 'Back',\n      or: 'or',\n      dropzone: 'Drop Here',\n      upload: 'Choose a File',\n      drop: 'Drop the file to upload',\n      url: 'Enter URL or UUID',\n      layer: 'Layer',\n      stepOne: 'Upload a File or enter URL/UUID',\n      stepTwo: 'Select format',\n      stepThree: 'Configure layer',\n      stepFour: 'Enter Name',\n      service: 'Service Type',\n      name: 'Name',\n      layerSelect: 'Select Layer',\n      errorEmpty: 'cannot be empty',\n      errorNone: 'No file or source added',\n      errorFile: 'Only geoJSON and GeoPackage files can be used',\n      errorServer: 'source is not valid',\n      errorProj: 'does not support current map projection',\n      only: 'only',\n    },\n    fr: {\n      finish: 'Finir',\n      continue: 'Continuer',\n      back: 'Retour',\n      or: 'ou',\n      dropzone: 'Déposez ici',\n      upload: 'Choisir un fichier',\n      drop: 'Déposez le fichier à télécharger',\n      url: \"Entrer l'URL ou l'UUID\",\n      layer: 'Couche',\n      stepOne: \"Ajouter un fichier ou entrer l'URL/UUID\",\n      stepTwo: 'Sélectionnez le format',\n      stepThree: 'Configurer la couche',\n      stepFour: 'Entrez le nom',\n      service: 'Type de service',\n      name: 'Nom',\n      layerSelect: 'Sélectionner la couche',\n      errorEmpty: 'ne peut être vide',\n      errorNone: 'Pas de fichier ou de source ajouté',\n      errorFile: 'Seuls les fichiers geoJSON et GeoPackage peuvent être utilisés',\n      errorServer: \"source n'est pas valide\",\n      errorProj: 'ne prend pas en charge la projection cartographique actuelle',\n      only: 'seulement',\n    },\n  };\n\n  const snackbarEventOpenListenerFunction = (payload: PayloadBaseClass) => {\n    if (payloadIsASnackbarMessage(payload)) {\n      if (payload.message && payload.message.value === 'validation.layer.loadfailed') {\n        setIsLoading(false);\n      }\n    }\n  };\n\n  useEffect(() => {\n    api.event.on(api.eventNames.SNACKBAR.EVENT_SNACKBAR_OPEN, snackbarEventOpenListenerFunction, mapId);\n    return () => {\n      api.event.off(api.eventNames.SNACKBAR.EVENT_SNACKBAR_OPEN, mapId, snackbarEventOpenListenerFunction);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  /**\n   * Returns the appropriate error config for ESRI layer types\n   *\n   * @param type one of esriDynamic or esriFeature\n   * @returns {EsriOptions} an error configuration object for populating dialogues\n   */\n  const esriOptions = (type: string): EsriOptions => {\n    switch (type) {\n      case ESRI_DYNAMIC:\n        return { err: 'ESRI Map', capability: 'Map' };\n      case ESRI_FEATURE:\n        return { err: 'ESRI Feature', capability: 'Query' };\n      default:\n        return { err: '', capability: '' };\n    }\n  };\n\n  /**\n   * Emits an error dialogue when a text field is empty\n   *\n   * @param textField label for the TextField input that cannot be empty\n   */\n  const emitErrorEmpty = (textField: string) => {\n    setIsLoading(false);\n    api.utilities.showError(mapId, `${textField} ${translations[displayLanguage].errorEmpty}`, false);\n  };\n\n  /**\n   * Emits an error dialogue when a text field is empty\n   *\n   * @param textField label for the TextField input that cannot be empty\n   */\n  const emitErrorNone = () => {\n    setIsLoading(false);\n    api.utilities.showError(mapId, translations[displayLanguage].errorNone, false);\n  };\n\n  /**\n   * Emits an error dialogue when unsupported files are uploaded\n   *\n   * @param textField label for the TextField input that cannot be empty\n   */\n  const emitErrorFile = () => {\n    api.utilities.showError(mapId, translations[displayLanguage].errorFile, false);\n  };\n\n  /**\n   * Emits an error when the URL does not support the selected service type\n   *\n   * @param serviceName type of service provided by the URL\n   */\n  const emitErrorServer = (serviceName: string) => {\n    setIsLoading(false);\n    api.utilities.showError(mapId, `${serviceName} ${translations[displayLanguage].errorServer}`, false);\n  };\n\n  /**\n   * Emits an error when a service does not support the current map projection\n   *\n   * @param serviceName type of service provided by the URL\n   * @param proj current map projection\n   */\n  const emitErrorProj = (serviceName: string, proj: string | undefined, supportedProj: TypeJsonArray | string[]) => {\n    setIsLoading(false);\n    const message = `${serviceName} ${translations[displayLanguage].errorProj} ${proj}, ${\n      translations[displayLanguage].only\n    } ${supportedProj.join(', ')}`;\n    api.utilities.showError(mapId, message, false);\n  };\n\n  /**\n   * Using the layerURL state object, check whether URL is a valid WMS,\n   * and add either Name and Entry directly to state if a single layer,\n   * or a list of Names / Entries if multiple layer options exist.\n   *\n   * @returns {Promise<boolean>} True if layer passes validation\n   */\n  const wmsValidation = async (): Promise<boolean> => {\n    const proj = api.projection.projections[api.maps[mapId].currentProjection].getCode();\n    let supportedProj: string[] = [];\n\n    try {\n      const [baseUrl, queryString] = layerURL.split('?');\n      const urlParams = new URLSearchParams(queryString);\n      const paramLayers = urlParams.get('layers')?.split(',') || [''];\n      // query layers are not sent, as not all services support asking for multiple layers\n      const wms = await api.geoUtilities.getWMSServiceMetadata(baseUrl, '');\n\n      supportedProj = wms.Capability.Layer.CRS as string[];\n      if (!supportedProj.includes(proj)) throw new Error('proj');\n\n      const layers: TypeJsonArray[] = [];\n\n      const hasChildLayers = (layer: TypeJsonObject) => {\n        if (layer.Layer && (layer.Layer as TypeJsonArray).length > 0) {\n          (layer.Layer as TypeJsonObject[]).forEach((childLayer: TypeJsonObject) => {\n            hasChildLayers(childLayer);\n          });\n        } else {\n          for (let i = 0; i < paramLayers.length; i++) {\n            if ((layer.Name as string) === paramLayers[i]) layers.push([layer.Name, layer.Title] as TypeJsonArray);\n          }\n        }\n      };\n\n      if (wms.Capability.Layer) {\n        hasChildLayers(wms.Capability.Layer);\n      }\n\n      if (layers.length === 1) {\n        setLayerName(layers[0][1] as string);\n        setLayerEntries([\n          {\n            layerId: layers[0][0] as string,\n          },\n        ] as TypeListOfLayerEntryConfig);\n      } else {\n        setLayerList(layers);\n      }\n    } catch (err) {\n      if ((err as Error).message === 'proj') {\n        emitErrorProj('WMS', proj, supportedProj);\n      } else {\n        emitErrorServer('WMS');\n      }\n      return false;\n    }\n    return true;\n  };\n\n  /**\n   * Using the layerURL state object, check whether URL is a valid WFS,\n   * and add either Name and Entry directly to state if a single layer,\n   * or a list of Names / Entries if multiple layer options exist.\n   *\n   * @returns {Promise<boolean>} True if layer passes validation\n   */\n  const wfsValidation = async (): Promise<boolean> => {\n    try {\n      const wfs = await api.geoUtilities.getWFSServiceMetadata(layerURL);\n      const layers = (wfs.FeatureTypeList.FeatureType as TypeJsonArray).map((aFeatureType) => [\n        (aFeatureType.Name['#text'] as string).split(':')[1] as TypeJsonObject,\n        aFeatureType.Title['#text'],\n      ]);\n      if (layers.length === 1) {\n        setLayerName(layers[0][1] as string);\n        setLayerEntries([\n          {\n            layerId: layers[0][0] as string,\n          },\n        ] as TypeListOfLayerEntryConfig);\n      } else {\n        setLayerList(layers);\n      }\n    } catch (err) {\n      emitErrorServer('WFS');\n      return false;\n    }\n    return true;\n  };\n\n  /**\n   * Using the layerURL state object, check whether URL is a valid OGC API. You can either provide a single\n   * layer URL or the root OGC API where the user can select any number of layers in the collection\n   *\n   * @returns {Promise<boolean>} True if layer passes validation\n   */\n  const ogcFeatureValidation = async (): Promise<boolean> => {\n    const keysSingleLayer = ['id', 'title'];\n    const responseSingle = await fetch(`${layerURL}/?f=json`);\n    if (responseSingle.status !== 200) {\n      emitErrorServer('OGC API Feature');\n      return false;\n    }\n    const jsonSingle = await responseSingle.json();\n    const isSingleLayerValid = keysSingleLayer.every((key) => Object.keys(jsonSingle).includes(key));\n    if (isSingleLayerValid) {\n      setLayerEntries([\n        {\n          layerId: jsonSingle.id,\n        },\n      ] as TypeListOfLayerEntryConfig);\n      setLayerName(jsonSingle.title);\n      return true;\n    }\n\n    try {\n      const keys = ['collections', 'links'];\n      const responseCollection = await fetch(`${layerURL}/collections?f=json`);\n      const jsonCollection = await responseCollection.json();\n      const isCollectionValid = keys.every((key) => Object.keys(jsonCollection).includes(key));\n      if (!isCollectionValid) throw new Error('err');\n      const layers = (jsonCollection.collections as TypeJsonArray).map((aFeatureType) => [aFeatureType.id, aFeatureType.title]);\n      if (layers.length === 1) {\n        setLayerName(layers[0][1] as string);\n        setLayerEntries([\n          {\n            layerId: layers[0][0] as string,\n          },\n        ] as TypeListOfLayerEntryConfig);\n      } else {\n        setLayerList(layers);\n      }\n    } catch (err) {\n      emitErrorServer('OGC API Feature');\n      return false;\n    }\n    return true;\n  };\n\n  /**\n   * Using the layerURL state object, check whether URL is a valid Geocore UUID.\n   *\n   * @returns {Promise<boolean>} True if layer passes validation\n   */\n  const geocoreValidation = (): boolean => {\n    try {\n      const isValid = layerURL.indexOf('/') === -1 && layerURL.replaceAll('-', '').length === 32;\n      if (!isValid) throw new Error('err');\n      setLayerName('');\n      setLayerEntries([\n        {\n          layerId: layerURL,\n        },\n      ] as TypeListOfLayerEntryConfig);\n    } catch (err) {\n      emitErrorServer('GeoCore UUID');\n      return false;\n    }\n    return true;\n  };\n\n  /**\n   * Using the layerURL state object, check whether URL is a valid ESRI Server,\n   * and add either Name and Entry directly to state if a single layer,\n   * or a list of Names / Entries if multiple layer options exist.\n   *\n   * @returns {Promise<boolean>} True if layer passes validation\n   */\n  const esriValidation = async (type: string): Promise<boolean> => {\n    try {\n      const esri = await api.geoUtilities.getESRIServiceMetadata(layerURL);\n      if ((esri.capabilities as string).includes(esriOptions(type).capability)) {\n        if ('layers' in esri) {\n          const layers = (esri.layers as TypeJsonArray).map((aLayer) => [aLayer.id, aLayer.name]);\n          if (layers.length === 1) {\n            setLayerName(layers[0][1] as string);\n            setLayerEntries([\n              {\n                layerId: layers[0][0] as string,\n              },\n            ] as TypeListOfLayerEntryConfig);\n          } else {\n            setLayerList(layers);\n          }\n        } else {\n          setLayerName(esri.name as string);\n          setLayerEntries([\n            {\n              layerId: esri.id as string,\n            },\n          ] as TypeListOfLayerEntryConfig);\n        }\n      } else {\n        throw new Error('err');\n      }\n    } catch (err) {\n      emitErrorServer(esriOptions(type).err);\n      return false;\n    }\n    return true;\n  };\n\n  /**\n   * Using the layerURL state object, check whether URL is a valid XYZ Server.\n   *\n   * @returns {boolean} True if layer passes validation\n   */\n  const xyzValidation = (): boolean => {\n    const tiles = ['{x}', '{y}', '{z}'];\n    for (let i = 0; i < tiles.length; i += 1) {\n      if (!layerURL.includes(tiles[i])) {\n        emitErrorServer('XYZ Tile');\n        return false;\n      }\n    }\n    const dataAccessPath = layerURL;\n    setLayerName('');\n    setLayerEntries([\n      {\n        layerId: layerURL,\n        source: {\n          dataAccessPath: {\n            en: dataAccessPath,\n            fr: dataAccessPath,\n          },\n        },\n      },\n    ] as TypeListOfLayerEntryConfig);\n    return true;\n  };\n\n  /**\n   * Using the layerURL state object, check whether URL is a valid GeoJSON.\n   *\n   * @returns {Promise<boolean>} True if layer passes validation\n   */\n  const geoJSONValidation = async (): Promise<boolean> => {\n    try {\n      const response = await fetch(layerURL);\n      const json = await response.json();\n      if (!['FeatureCollection', 'Feature'].includes(json.type)) {\n        throw new Error('err');\n      }\n      const layerId = layerURL.split('/').pop() as string;\n      const dataAccessPath = layerURL.replace(layerId, '');\n      if (!layerName) setLayerName(layerId);\n      setLayerEntries([\n        {\n          layerId,\n          source: {\n            dataAccessPath: {\n              en: dataAccessPath,\n              fr: dataAccessPath,\n            },\n          },\n        },\n      ] as TypeListOfLayerEntryConfig);\n    } catch (err) {\n      emitErrorServer('GeoJSON');\n      return false;\n    }\n    return true;\n  };\n\n  /**\n   * Using the layerURL state object, check whether URL is a valid GeoPackage.\n   *\n   * @returns {Promise<boolean>} True if layer passes validation\n   */\n  const geoPackageValidation = (): boolean => {\n    // TODO actual geopackage validation\n    const layerId = layerURL.split('/').pop() as string;\n    const dataAccessPath = layerURL.replace(layerId, '');\n    if (!layerName) setLayerName(layerId);\n    setLayerEntries([\n      {\n        layerId,\n        source: {\n          dataAccessPath: {\n            en: dataAccessPath,\n            fr: dataAccessPath,\n          },\n        },\n      },\n    ] as TypeListOfLayerEntryConfig);\n    return true;\n  };\n\n  /**\n   * Attempt to determine the layer type based on the URL format\n   */\n  const bestGuessLayerType = () => {\n    const layerTokens = displayURL.toUpperCase().split('/');\n    const layerId = parseInt(layerTokens[layerTokens.length - 1], 10);\n    if (displayURL.toUpperCase().endsWith('MAPSERVER') || displayURL.toUpperCase().endsWith('MAPSERVER/')) {\n      setLayerType(ESRI_DYNAMIC);\n    } else if (\n      displayURL.toUpperCase().indexOf('FEATURESERVER') !== -1 ||\n      (displayURL.toUpperCase().indexOf('MAPSERVER') !== -1 && !Number.isNaN(layerId))\n    ) {\n      setLayerType(ESRI_FEATURE);\n    } else if (layerTokens.indexOf('WFS') !== -1) {\n      setLayerType(WFS);\n    } else if (displayURL.toUpperCase().endsWith('.JSON') || displayURL.toUpperCase().endsWith('.GEOJSON')) {\n      setLayerType(GEOJSON);\n    } else if (displayURL.toUpperCase().endsWith('.GPKG')) {\n      setLayerType(GEOPACKAGE);\n    } else if (displayURL.toUpperCase().indexOf('{Z}/{X}/{Y}') !== -1 || displayURL.toUpperCase().indexOf('{Z}/{Y}/{X}') !== -1) {\n      setLayerType(XYZ_TILES);\n    } else if (displayURL.indexOf('/') === -1 && displayURL.replaceAll('-', '').length === 32) {\n      setLayerType(GEOCORE);\n    } else if (displayURL.toUpperCase().indexOf('WMS') !== -1) {\n      setLayerType(WMS);\n    }\n  };\n\n  /**\n   * Handle the behavior of the 'Continue' button in the Stepper UI\n   */\n  const handleStep1 = () => {\n    let valid = true;\n    if (layerURL.trim() === '') {\n      valid = false;\n      emitErrorNone();\n    }\n    if (valid) {\n      bestGuessLayerType();\n      setActiveStep(1);\n    }\n  };\n\n  /**\n   * Handle the behavior of the 'Continue' button in the Stepper UI\n   */\n  const handleStep2 = async () => {\n    setIsLoading(true);\n    let valid = true;\n    if (layerType === undefined) {\n      valid = false;\n      setIsLoading(false);\n      emitErrorEmpty(translations[displayLanguage].service);\n    } else if (layerType === WMS) valid = await wmsValidation();\n    else if (layerType === WFS) valid = await wfsValidation();\n    else if (layerType === OGC_FEATURE) valid = await ogcFeatureValidation();\n    else if (layerType === XYZ_TILES) valid = xyzValidation();\n    else if (layerType === ESRI_DYNAMIC) valid = await esriValidation(ESRI_DYNAMIC);\n    else if (layerType === ESRI_FEATURE) valid = await esriValidation(ESRI_FEATURE);\n    else if (layerType === GEOJSON) valid = await geoJSONValidation();\n    else if (layerType === GEOPACKAGE) valid = geoPackageValidation();\n    else if (layerType === GEOCORE) valid = geocoreValidation();\n    if (valid) {\n      setIsLoading(false);\n      setActiveStep(2);\n    }\n  };\n\n  /**\n   * Handle the behavior of the 'Finish' button in the Stepper UI\n   */\n  const handleStep3 = () => {\n    let valid = true;\n    if (layerEntries.length === 0) {\n      valid = false;\n      emitErrorEmpty(translations[displayLanguage].layer);\n    }\n    if (valid) setActiveStep(3);\n  };\n\n  /**\n   * Handle the behavior of the 'Finish' button in the Stepper UI\n   */\n  const handleStepLast = () => {\n    setIsLoading(true);\n    const geoviewLayerId = api.generateId();\n    api.event.on(\n      api.eventNames.LAYER.EVENT_LAYER_ADDED,\n      () => {\n        api.event.off(api.eventNames.LAYER.EVENT_LAYER_ADDED, mapId);\n        setIsLoading(false);\n        setAddLayerVisible(false);\n      },\n      `${mapId}/${geoviewLayerId}`\n    );\n\n    let valid = true;\n    const name = layerName;\n    let url = layerURL;\n    if (layerType === ESRI_DYNAMIC || layerType === ESRI_FEATURE) {\n      url = api.geoUtilities.getMapServerUrl(layerURL);\n    }\n    if (layerType === WMS) {\n      [url] = layerURL.split('?');\n    }\n\n    if (layerName === '') {\n      valid = false;\n      emitErrorEmpty(isMultiple() ? translations[displayLanguage].layer : translations[displayLanguage].name);\n    }\n    const layerConfig: TypeGeoviewLayerConfig = {\n      geoviewLayerId,\n      geoviewLayerName: {\n        en: name,\n        fr: name,\n      },\n      geoviewLayerType: layerType as TypeGeoviewLayerType,\n      metadataAccessPath: {\n        en: url,\n        fr: url,\n      },\n      listOfLayerEntryConfig: layerEntries as TypeListOfLayerEntryConfig,\n    };\n\n    if (layerType === GEOJSON || layerType === XYZ_TILES || layerType === GEOPACKAGE) {\n      // TODO probably want an option to add metadata if geojson or geopackage\n      // need to clear our metadata path or it will give errors trying to find it\n      layerConfig.metadataAccessPath = {\n        en: '',\n        fr: '',\n      };\n    }\n    if (layerType === GEOCORE) {\n      delete layerConfig.metadataAccessPath;\n    }\n    if (layerType === OGC_FEATURE) {\n      // make sure the metadataAccessPath is the root OGC API URL\n      layerConfig.metadataAccessPath = {\n        en: api.geoUtilities.getOGCServerUrl(layerURL),\n        fr: api.geoUtilities.getOGCServerUrl(layerURL),\n      };\n    }\n    if (valid) {\n      // TODO issue #668 - geocore layers do not have same ID, it is impossible to use the added event\n      // workaround - close after 3 sec\n      if (layerType === GEOCORE) {\n        setTimeout(() => {\n          setIsLoading(false);\n          setAddLayerVisible(false);\n        }, 3000);\n      }\n\n      if (layerConfig.geoviewLayerId) {\n        api.maps[mapId].layer.layerOrder.push(layerConfig.geoviewLayerId);\n      } else if (layerConfig.listOfLayerEntryConfig !== undefined) {\n        layerConfig.listOfLayerEntryConfig.forEach((subLayer: TypeLayerEntryConfig) => {\n          if (subLayer.layerId) api.maps[mapId].layer.layerOrder.unshift(subLayer.layerId);\n        });\n      }\n\n      api.maps[mapId].layer.addGeoviewLayer(layerConfig);\n    }\n  };\n\n  /**\n   * Handle the behavior of the 'Back' button in the Stepper UI\n   */\n  const handleBack = () => {\n    setActiveStep((prevActiveStep: number) => prevActiveStep - 1);\n  };\n\n  /**\n   * Set layer URL from file input\n   *\n   * @param {File} file uploaded file\n   */\n  const handleFile = (file: File) => {\n    const fileURL = URL.createObjectURL(file);\n    setDisplayURL(file.name);\n    setLayerURL(fileURL);\n    const fileName = file.name.split('.')[0];\n    setLayerType('');\n    setLayerList([]);\n    setLayerName(fileName);\n    setLayerEntries([]);\n  };\n\n  /**\n   * Set layer URL from form input\n   *\n   * @param e TextField event\n   */\n  const handleInput = (event: Event) => {\n    setDisplayURL(event.target.value.trim());\n    setLayerURL(event.target.value.trim());\n    setLayerType('');\n    setLayerList([]);\n    setLayerName('');\n    setLayerEntries([]);\n  };\n\n  /**\n   * Set layerType from form input\n   *\n   * @param {SelectChangeEvent} event TextField event\n   */\n  const handleSelectType = (event: SelectChangeEvent<unknown>) => {\n    setLayerType(event.target.value as TypeGeoviewLayerType);\n    setLayerList([]);\n    setLayerEntries([]);\n  };\n\n  /**\n   * Set the currently selected layer from a list\n   *\n   * @param event Select event\n   * @param newValue value/label pairs of select options\n   */\n  const handleSelectLayer = (event: Event, newValue: string[]) => {\n    if (isMultiple()) {\n      setLayerEntries(\n        newValue.map((x: string) => {\n          return { layerId: `${x[0]}` };\n        }) as TypeListOfLayerEntryConfig\n      );\n      setLayerName(newValue.map((x) => x[1]).join(', '));\n    } else {\n      setLayerEntries([{ layerId: `${newValue[0]}` }] as TypeListOfLayerEntryConfig);\n      setLayerName(newValue[1]);\n    }\n  };\n\n  /**\n   * Set the layer name from form input\n   *\n   * @param e TextField event\n   */\n  const handleNameLayer = (event: Event) => {\n    setLayerName(event.target.value);\n  };\n\n  /**\n   * Handle file dragged into dropzone\n   *\n   * @param {DragEvent<HTMLDivElement>} event Drag event\n   */\n  const handleDragEnter = (event: React.DragEvent<HTMLDivElement>) => {\n    event.preventDefault();\n    event.stopPropagation();\n    if (event.target !== dragPopover.current) {\n      setDrag(true);\n    }\n  };\n\n  /**\n   * Handle file dragged out of dropzone\n   *\n   * @param {DragEvent<HTMLDivElement>} event Drag event\n   */\n  const handleDragLeave = (event: React.DragEvent<HTMLDivElement>) => {\n    event.preventDefault();\n    event.stopPropagation();\n    if (event.target === dragPopover.current) setDrag(false);\n  };\n\n  /**\n   * Prevent default behaviour when file dragged over dropzone\n   *\n   * @param {DragEvent<HTMLDivElement>} event Drag event\n   */\n  const handleDragOver = (event: React.DragEvent<HTMLDivElement>) => {\n    event.preventDefault();\n    event.stopPropagation();\n  };\n\n  /**\n   * Handle file drop\n   *\n   * @param {DragEvent<HTMLDivElement>} event Drag event\n   */\n  const handleDrop = (event: React.DragEvent<HTMLDivElement>) => {\n    event.preventDefault();\n    event.stopPropagation();\n    setDrag(false);\n    if (event.dataTransfer?.files) {\n      const file = event.dataTransfer.files[0];\n      const upFilename = file.name.toUpperCase();\n      if (upFilename.endsWith('.JSON') || upFilename.endsWith('.GEOJSON') || upFilename.endsWith('.GPKG')) {\n        handleFile(file);\n      } else {\n        emitErrorFile();\n      }\n    }\n  };\n\n  /**\n   * Creates a set of Continue / Back buttons\n   *\n   * @param param0 specify if button is first or last in the list\n   * @returns {JSX.Element} React component\n   */\n  // eslint-disable-next-line react/no-unstable-nested-components\n  function NavButtons({ isFirst = false, isLast = false, handleNext }: ButtonPropsLayerPanel): JSX.Element {\n    return isLoading ? (\n      <Box sx={{ padding: 10 }}>\n        <CircularProgressBase />\n      </Box>\n    ) : (\n      <ButtonGroup sx={sxClasses.buttonGroup}>\n        <Button variant=\"contained\" type=\"text\" onClick={handleNext}>\n          {isLast ? translations[displayLanguage].finish : translations[displayLanguage].continue}\n        </Button>\n        {!isFirst && (\n          <Button variant=\"contained\" type=\"text\" onClick={handleBack}>\n            {translations[displayLanguage].back}\n          </Button>\n        )}\n      </ButtonGroup>\n    );\n  }\n\n  return (\n    <>\n      <Box sx={{ display: 'flex', justifyContent: 'end', zIndex: 2 }}>\n        <IconButton color=\"primary\" onClick={() => setAddLayerVisible(false)}>\n          <CloseIcon />\n        </IconButton>\n      </Box>\n      <Stepper\n        sx={{ position: 'relative', top: '-30px', zIndex: 1 }}\n        activeStep={activeStep}\n        orientation=\"vertical\"\n        steps={[\n          {\n            stepLabel: {\n              children: translations[displayLanguage].stepOne,\n            },\n            stepContent: {\n              children: (\n                <div\n                  className=\"dropzone\"\n                  style={{ position: 'relative' }}\n                  onDrop={(e) => handleDrop(e)}\n                  onDragOver={(e) => handleDragOver(e)}\n                  onDragEnter={(e) => handleDragEnter(e)}\n                  onDragLeave={(e) => handleDragLeave(e)}\n                >\n                  {drag && (\n                    <div\n                      ref={dragPopover}\n                      style={{\n                        backgroundColor: 'rgba(128,128,128,.95)',\n                        position: 'absolute',\n                        top: 0,\n                        bottom: 0,\n                        left: 0,\n                        right: 0,\n                        zIndex: 9999,\n                        textAlign: 'center',\n                        color: 'black',\n                        fontSize: 24,\n                      }}\n                    >\n                      <h3>\n                        <br />\n                        <br />\n                        {translations[displayLanguage].dropzone}\n                      </h3>\n                    </div>\n                  )}\n                  <div>\n                    <input\n                      type=\"file\"\n                      id=\"fileUpload\"\n                      style={{ display: 'none' }}\n                      onChange={(e) => {\n                        if (e.target.files) handleFile(e.target.files[0]);\n                      }}\n                      accept=\".gpkg, .json, .geojson\"\n                    />\n                  </div>\n                  <Button type=\"text\" onClick={() => document.getElementById('fileUpload')?.click()} className=\"\">\n                    <FileUploadIcon />\n                    <span>{translations[displayLanguage].upload}</span>\n                  </Button>\n                  <p style={{ textAlign: 'center' }}>\n                    <small>{translations[displayLanguage].drop}</small>\n                  </p>\n                  <p style={{ textAlign: 'center' }}>{translations[displayLanguage].or}</p>\n                  <TextField\n                    sx={{ width: '100%' }}\n                    label={translations[displayLanguage].url}\n                    variant=\"standard\"\n                    value={displayURL}\n                    onChange={handleInput}\n                    multiline\n                  />\n                  <br />\n                  <NavButtons isFirst handleNext={handleStep1} />\n                </div>\n              ),\n            },\n          },\n          {\n            stepLabel: {\n              children: translations[displayLanguage].stepTwo,\n            },\n            stepContent: {\n              children: (\n                <>\n                  <Select\n                    fullWidth\n                    labelId=\"service-type-label\"\n                    value={layerType}\n                    onChange={handleSelectType}\n                    label={translations[displayLanguage].service}\n                    inputLabel={{\n                      id: 'service-type-label',\n                    }}\n                    menuItems={layerOptions.map(([value, label]) => ({\n                      key: value,\n                      item: {\n                        value,\n                        children: label,\n                      },\n                    }))}\n                  />\n                  <NavButtons handleNext={handleStep2} />\n                </>\n              ),\n            },\n          },\n          {\n            stepLabel: {\n              children: translations[displayLanguage].stepThree,\n            },\n            stepContent: {\n              children: (\n                <>\n                  {layerList.length === 0 && (\n                    <TextField label={translations[displayLanguage].name} variant=\"standard\" value={layerName} onChange={handleNameLayer} />\n                  )}\n                  {layerList.length > 1 && (\n                    <Autocomplete\n                      fullWidth\n                      multiple={isMultiple()}\n                      disableClearable={!isMultiple()}\n                      id=\"service-layer-label\"\n                      options={layerList}\n                      getOptionLabel={(option) => `${option[1]} (${option[0]})`}\n                      renderOption={(props, option) => <span {...props}>{option[1] as string}</span>}\n                      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                      onChange={handleSelectLayer as any}\n                      renderInput={(params) => <TextField {...params} label={translations[displayLanguage].layerSelect} />}\n                    />\n                  )}\n                  <br />\n                  <NavButtons isLast={!isMultiple()} handleNext={isMultiple() ? handleStep3 : handleStepLast} />\n                </>\n              ),\n            },\n          },\n          isMultiple()\n            ? {\n                stepLabel: {\n                  children: translations[displayLanguage].stepFour,\n                },\n                stepContent: {\n                  children: (\n                    <>\n                      <TextField\n                        sx={{ width: '100%' }}\n                        label={translations[displayLanguage].name}\n                        variant=\"standard\"\n                        value={layerName}\n                        onChange={handleNameLayer}\n                      />\n                      <br />\n                      <NavButtons isLast handleNext={handleStepLast} />\n                    </>\n                  ),\n                },\n              }\n            : null,\n        ]}\n      />\n    </>\n  );\n}\n\nexport default LayerStepper;\n","/* eslint-disable react/require-default-props */\nimport { TypeWindow } from 'geoview-core';\nimport { DragDropContext, Draggable, Droppable, DropResult } from 'react-beautiful-dnd';\n\ninterface Props {\n  mapId: string;\n  title: string;\n  layerIds: string[];\n  setReorderLayersVisible: (isVisible: boolean) => void;\n  setMapLayers: (reorderedLayerIds: string[]) => void;\n}\n\nconst w = window as TypeWindow;\n\n/**\n * A react component that displays the reorderable layers list\n *\n * @returns {JSX.Element} A React JSX Element with the reorderable layers list\n */\nfunction ReorderLayersList({ mapId, title, layerIds, setReorderLayersVisible, setMapLayers }: Props): JSX.Element {\n  const { cgpv } = w;\n  const { api, ui } = cgpv;\n\n  const { List, ListItem, ListItemButton, ListItemIcon, HandleIcon, ListItemText, Box, IconButton, CloseIcon } = ui.elements;\n\n  const { displayLanguage } = api.maps[mapId!];\n\n  const sxClasses = {\n    titleBar: {\n      position: 'relative',\n      top: '-30px',\n      zIndex: 1,\n    },\n    draggableList: {\n      top: '-30px',\n    },\n    regularListItem: {\n      color: 'text.primary',\n      padding: 0,\n    },\n    draggingListItem: {\n      color: 'text.primary',\n      padding: 0,\n      background: 'rgb(235,235,235,0.5)',\n    },\n    listItemText: {\n      fontSize: 14,\n      noWrap: true,\n    },\n    handleIcon: {\n      margin: '8px 0px',\n    },\n  };\n\n  const onDragEnd = ({ destination, source }: DropResult) => {\n    if (!destination) return; // dropped outside the list\n    const reorderedLayerIds = [...layerIds];\n    const [removed] = reorderedLayerIds.splice(source.index, 1);\n    reorderedLayerIds.splice(destination.index, 0, removed);\n    api.maps[mapId].layer.moveLayer(removed, destination.index);\n    setMapLayers(reorderedLayerIds);\n  };\n\n  const getLayerName = (layerId: string) => {\n    return api.maps[mapId].layer.geoviewLayers[layerId].geoviewLayerName[displayLanguage];\n  };\n\n  return (\n    <>\n      <Box sx={{ display: 'flex', justifyContent: 'end', zIndex: 2 }}>\n        <IconButton color=\"primary\" onClick={() => setReorderLayersVisible(false)}>\n          <CloseIcon />\n        </IconButton>\n      </Box>\n      <Box sx={sxClasses.titleBar}>{title}</Box>\n      <DragDropContext onDragEnd={onDragEnd}>\n        <Droppable droppableId=\"droppable\">\n          {(provided) => (\n            <List sx={sxClasses.draggableList} {...provided.droppableProps} innerref={provided.innerRef}>\n              {layerIds.map((layerId, index) => (\n                <Draggable key={layerId} draggableId={layerId} index={index}>\n                  {(providedDrag, snapshotDrag) => (\n                    <ListItem\n                      innerref={providedDrag.innerRef}\n                      sx={snapshotDrag.isDragging ? sxClasses.draggingListItem : sxClasses.regularListItem}\n                      {...providedDrag.draggableProps}\n                      {...providedDrag.dragHandleProps}\n                    >\n                      <ListItemButton>\n                        <ListItemIcon>\n                          <HandleIcon sx={sxClasses.handleIcon} />\n                        </ListItemIcon>\n                        <ListItemText primaryTypographyProps={sxClasses.listItemText} primary={getLayerName(layerId)} />\n                      </ListItemButton>\n                    </ListItem>\n                  )}\n                </Draggable>\n              ))}\n              {provided.placeholder}\n            </List>\n          )}\n        </Droppable>\n      </DragDropContext>\n    </>\n  );\n}\n\nexport default ReorderLayersList;\n","import type React from 'react';\nimport { toJsonObject, TypeJsonObject, TypeWindow, TypeButtonPanel } from 'geoview-core';\n\nimport LayerStepper from './layer-stepper';\nimport ReorderLayersList from './reorder-layers-list';\n\ntype TypePanelContentProps = {\n  buttonPanel: TypeButtonPanel;\n  mapId: string;\n};\n\nconst w = window as TypeWindow;\n\n/**\n * A react component that displays the details panel content\n *\n * @param {TypePanelContentProps} props the properties of the pane content\n * @returns {JSX.Element} A React JSX Element with the details panel\n */\nfunction PanelContent(props: TypePanelContentProps): JSX.Element {\n  const { mapId, buttonPanel } = props;\n\n  const { cgpv } = w;\n  const { api, ui, react } = cgpv;\n  const { useState, useEffect } = react;\n  const [addLayerVisible, setAddLayerVisible] = useState(false);\n  const [reorderLayersVisible, setReorderLayersVisible] = useState(false);\n  const [mapLayers, setMapLayers] = useState<string[]>([]);\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  const [legend, setLegend] = useState<React.DetailedReactHTMLElement<{}, HTMLElement>>();\n  const [actionMenuAnchorElement, setActionMenuAnchorElement] = useState<null | HTMLElement>(null);\n  const [isExpandAll, setExpandAll] = useState<boolean>(false);\n  const [isHideAll, setHideAll] = useState<boolean>(false);\n  const {\n    IconButton,\n    AddIcon,\n    Box,\n    ExpandMoreIcon,\n    ExpandLessIcon,\n    VisibilityIcon,\n    VisibilityOffIcon,\n    Menu,\n    MenuItem,\n    MenuIcon,\n    ListItemIcon,\n    ListItemText,\n    ReorderIcon,\n  } = ui.elements;\n\n  const { displayLanguage } = api.maps[mapId!];\n\n  const translations: TypeJsonObject = toJsonObject({\n    en: {\n      addLayer: 'Add Layer',\n      expandAll: 'Expand Groups',\n      collapseAll: 'Collapse Groups',\n      showAll: 'Show All',\n      hideAll: 'Hide All',\n      reorderLayers: 'Reorder Layers',\n    },\n    fr: {\n      addLayer: 'Ajouter Couche',\n      expandAll: 'Élargir les groupes',\n      collapseAll: 'Réduire les groupes',\n      showAll: 'Montrer tout',\n      hideAll: 'Cacher tout',\n      reorderLayers: 'Réorganiser les couches',\n    },\n  });\n\n  const sxClasses = {\n    mainContainer: {\n      display: 'flex',\n      flexDirection: 'column',\n      height: 'inherit',\n    },\n    topControls: {\n      display: 'flex',\n      flexDirection: 'row',\n      justifyContent: 'space-between',\n    },\n    addLayerSection: {\n      display: 'flex',\n      alignItems: 'center',\n      marginTop: 'auto',\n      justifyContent: 'end',\n    },\n  };\n\n  const actionMenuOpen = Boolean(actionMenuAnchorElement);\n\n  const updateLayers = () => {\n    if (api.maps[mapId].layer?.layerOrder !== undefined) setMapLayers([...api.maps[mapId].layer.layerOrder].reverse());\n  };\n\n  useEffect(() => {\n    api.event.on(api.eventNames.MAP.EVENT_MAP_LOADED, updateLayers, mapId);\n    api.event.on(api.eventNames.GET_LEGENDS.LEGENDS_LAYERSET_UPDATED, updateLayers, `${mapId}/LegendsLayerSet`);\n\n    return () => {\n      api.event.off(api.eventNames.MAP.EVENT_MAP_LOADED, mapId, updateLayers);\n      api.event.off(api.eventNames.GET_LEGENDS.LEGENDS_LAYERSET_UPDATED, mapId, updateLayers);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    setLegend(api.maps[mapId!].legend.createLegend({ layerIds: mapLayers, isRemoveable: true, canSetOpacity: true, canZoomTo: true }));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [mapLayers]);\n\n  useEffect(() => {\n    const setAddLayerVisibleListenerFunction = () => setAddLayerVisible(false);\n\n    api.event.on(api.eventNames.PANEL.EVENT_PANEL_CLOSE, setAddLayerVisibleListenerFunction, `${mapId}/${buttonPanel.buttonPanelId}`);\n    return () => {\n      api.event.off(api.eventNames.PANEL.EVENT_PANEL_CLOSE, `${mapId}/${buttonPanel.buttonPanelId}`, setAddLayerVisibleListenerFunction);\n    };\n  }, [api, buttonPanel.buttonPanelId, mapId]);\n\n  useEffect(() => {\n    setLegend(\n      api.maps[mapId!].legend.createLegend({\n        layerIds: mapLayers,\n        isRemoveable: true,\n        canSetOpacity: true,\n        expandAll: isExpandAll,\n        canZoomTo: true,\n      })\n    );\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isExpandAll]);\n\n  useEffect(() => {\n    setLegend(\n      api.maps[mapId!].legend.createLegend({\n        layerIds: mapLayers,\n        isRemoveable: true,\n        canSetOpacity: true,\n        hideAll: isHideAll,\n        canZoomTo: true,\n      })\n    );\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isHideAll]);\n\n  const handleShowAddLayer = () => {\n    setAddLayerVisible((state: boolean) => !state);\n  };\n\n  const handleExpandMenuClick = (event: React.MouseEvent<HTMLElement>) => {\n    setActionMenuAnchorElement(event.currentTarget);\n  };\n  const handleCloseMenu = () => {\n    setActionMenuAnchorElement(null);\n  };\n\n  const handleExpandAllClick = (isExpand: boolean) => {\n    setExpandAll(isExpand);\n    handleCloseMenu();\n  };\n\n  const handleShowAllClick = (isShow: boolean) => {\n    setHideAll(!isShow);\n    handleCloseMenu();\n  };\n\n  const handleReorderLayersClick = (isReorder: boolean) => {\n    setReorderLayersVisible(isReorder);\n    handleCloseMenu();\n  };\n\n  useEffect(() => {\n    // this will disable all scrolling when the user is trying to reorder layers\n    // TODO see issue #754 and atlassian/react-beautiful-dnd#460 - there may be a more elegant solution eventually if supported from the react-beautiful-dnd library\n    if (reorderLayersVisible) {\n      const x = w.scrollX;\n      const y = w.scrollY;\n      w.onscroll = () => {\n        w.scrollTo(x, y);\n      };\n    } else {\n      // eslint-disable-next-line @typescript-eslint/no-empty-function\n      w.onscroll = () => {};\n    }\n  }, [reorderLayersVisible]);\n\n  return (\n    <>\n      <Menu anchorEl={actionMenuAnchorElement} open={actionMenuOpen} onClose={handleCloseMenu}>\n        <MenuItem onClick={() => handleExpandAllClick(true)}>\n          <ListItemIcon>\n            <ExpandMoreIcon />\n          </ListItemIcon>\n          <ListItemText>{translations[displayLanguage].expandAll as string}</ListItemText>\n        </MenuItem>\n        <MenuItem onClick={() => handleExpandAllClick(false)}>\n          <ListItemIcon>\n            <ExpandLessIcon />\n          </ListItemIcon>\n          <ListItemText>{translations[displayLanguage].collapseAll as string}</ListItemText>\n        </MenuItem>\n        <MenuItem onClick={() => handleShowAllClick(true)}>\n          <ListItemIcon>\n            <VisibilityIcon />\n          </ListItemIcon>\n          <ListItemText>{translations[displayLanguage].showAll as string}</ListItemText>\n        </MenuItem>\n        <MenuItem onClick={() => handleShowAllClick(false)}>\n          <ListItemIcon>\n            <VisibilityOffIcon />\n          </ListItemIcon>\n          <ListItemText>{translations[displayLanguage].hideAll as string}</ListItemText>\n        </MenuItem>\n        <MenuItem onClick={() => handleReorderLayersClick(true)}>\n          <ListItemIcon>\n            <ReorderIcon />\n          </ListItemIcon>\n          <ListItemText>{translations[displayLanguage].reorderLayers as string}</ListItemText>\n        </MenuItem>\n      </Menu>\n      <Box sx={sxClasses.mainContainer}>\n        {addLayerVisible && <LayerStepper mapId={mapId!} setAddLayerVisible={setAddLayerVisible} />}\n        {reorderLayersVisible && (\n          <ReorderLayersList\n            mapId={mapId!}\n            title={translations[displayLanguage].reorderLayers as string}\n            layerIds={mapLayers}\n            setMapLayers={setMapLayers}\n            setReorderLayersVisible={setReorderLayersVisible}\n          />\n        )}\n        <Box sx={sxClasses.topControls} style={{ display: addLayerVisible || reorderLayersVisible ? 'none' : 'flex' }}>\n          <div>\n            <IconButton color=\"primary\" onClick={handleExpandMenuClick}>\n              <MenuIcon />\n            </IconButton>\n          </div>\n          <Box onClick={handleShowAddLayer}>\n            {translations[displayLanguage].addLayer as string}\n            <IconButton>\n              <AddIcon />\n            </IconButton>\n          </Box>\n        </Box>\n        <div style={{ display: addLayerVisible || reorderLayersVisible ? 'none' : 'block' }}>{legend}</div>\n      </Box>\n    </>\n  );\n}\n\nexport default PanelContent;\n","/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\nimport {\n  Cast,\n  AbstractPlugin,\n  toJsonObject,\n  TypeJsonObject,\n  TypeWindow,\n  TypePluginOptions,\n  TypeButtonPanel,\n  TypeIconButtonProps,\n  TypePanelProps,\n  AnySchemaObject,\n} from 'geoview-core';\nimport PanelContent from './panel-content';\nimport schema from '../schema.json';\nimport defaultConfig from '../default-config-layers-panel.json';\n\nconst w = window as TypeWindow;\n\n/**\n * Create a class for the plugin instance\n */\nclass LayersPanelPlugin extends AbstractPlugin {\n  // store the created button panel object\n  buttonPanel: TypeButtonPanel | null;\n\n  constructor(pluginId: string, props: TypePluginOptions) {\n    super(pluginId, props);\n    this.buttonPanel = null;\n  }\n\n  /**\n   * Return the schema that is defined for this package\n   *\n   * @returns {AnySchemaObject} returns the schema for this package\n   */\n  schema = (): AnySchemaObject => schema;\n\n  /**\n   * Return the default config for this package\n   *\n   * @returns {TypeJsonObject} the default config\n   */\n  defaultConfig = (): TypeJsonObject => toJsonObject(defaultConfig);\n\n  /**\n   * translations object to inject to the viewer translations\n   */\n  translations: TypeJsonObject = toJsonObject({\n    en: {\n      layersPanel: 'Layers',\n    },\n    fr: {\n      layersPanel: 'Couches',\n    },\n  });\n\n  /**\n   * Added function called after the plugin has been initialized\n   */\n  added(): void {\n    const { mapId } = (this as AbstractPlugin).pluginProps;\n\n    // access the cgpv object from the window object\n    const { cgpv } = w;\n\n    // access the api calls\n    const { api, ui } = cgpv;\n    const { LayersOutlinedIcon } = ui.elements;\n    const { displayLanguage } = api.maps[mapId];\n\n    let panelStatus = false;\n\n    panelStatus = (this as AbstractPlugin).configObj?.isOpen?.large as boolean;\n\n    // button props\n    const button: TypeIconButtonProps = {\n      id: 'layersPanelButton',\n      tooltip: this.translations[displayLanguage].layersPanel as string,\n      tooltipPlacement: 'right',\n      children: <LayersOutlinedIcon />,\n      visible: true,\n    };\n\n    // panel props\n    const panel: TypePanelProps = {\n      title: this.translations[displayLanguage].layersPanel,\n      icon: '<i class=\"material-icons\">layers</i>',\n      width: 350,\n      status: panelStatus,\n    };\n\n    // create a new button panel on the app-bar\n    this.buttonPanel = api.maps[mapId].appBarButtons.createAppbarPanel(button, panel, null);\n\n    // set panel content\n    this.buttonPanel?.panel?.changeContent(<PanelContent buttonPanel={this.buttonPanel} mapId={mapId} />);\n  }\n\n  /**\n   * Function called when the plugin is removed, used for clean up\n   */\n  removed(): void {\n    const { mapId } = (this as AbstractPlugin).pluginProps;\n\n    // access the cgpv object from the window object\n    const { cgpv } = w;\n\n    // access the api calls\n    const { api } = cgpv;\n\n    if (this.buttonPanel) {\n      api.maps[mapId].appBarButtons.removeAppbarPanel(this.buttonPanel.buttonPanelId);\n    }\n  }\n}\n\nexport default LayersPanelPlugin;\n\nw.plugins = w.plugins || {};\nw.plugins['layers-panel'] = Cast<AbstractPlugin>(LayersPanelPlugin);\n"],"names":["w","window","_ref","mapId","setAddLayerVisible","cgpv","api","ui","react","displayLanguage","maps","_api$layerTypes","layerTypes","ESRI_DYNAMIC","ESRI_FEATURE","GEOJSON","GEOPACKAGE","WMS","WFS","OGC_FEATURE","XYZ_TILES","GEOCORE","useState","useEffect","useRef","_ui$elements","elements","Select","Stepper","TextField","Button","ButtonGroup","Autocomplete","CircularProgressBase","Box","IconButton","CloseIcon","FileUploadIcon","_useState","_useState2","_slicedToArray","activeStep","setActiveStep","_useState3","_useState4","layerURL","setLayerURL","_useState5","_useState6","displayURL","setDisplayURL","_useState7","_useState8","layerType","setLayerType","_useState9","_useState10","layerList","setLayerList","_useState11","_useState12","layerName","setLayerName","_useState13","_useState14","layerEntries","setLayerEntries","_useState15","_useState16","isLoading","setIsLoading","_useState17","_useState18","drag","setDrag","dragPopover","sxClasses","buttonGroup","paddingTop","gap","isMultiple","layerOptions","translations","en","finish","continue","back","or","dropzone","upload","drop","url","layer","stepOne","stepTwo","stepThree","stepFour","service","name","layerSelect","errorEmpty","errorNone","errorFile","errorServer","errorProj","only","fr","snackbarEventOpenListenerFunction","payload","payloadIsASnackbarMessage","message","value","event","on","eventNames","SNACKBAR","EVENT_SNACKBAR_OPEN","off","esriOptions","type","err","capability","emitErrorEmpty","textField","utilities","showError","concat","emitErrorServer","serviceName","emitErrorProj","proj","supportedProj","join","wmsValidation","_ref2","_asyncToGenerator","_regeneratorRuntime","_callee","_urlParams$get","_layerURL$split","_layerURL$split2","baseUrl","queryString","urlParams","paramLayers","wms","layers","hasChildLayers","_context","prev","next","projection","projections","currentProjection","getCode","split","URLSearchParams","get","geoUtilities","getWMSServiceMetadata","sent","Capability","Layer","CRS","includes","Error","length","forEach","childLayer","i","Name","push","Title","layerId","t0","abrupt","stop","apply","arguments","wfsValidation","_ref3","_callee2","wfs","_layers","_context2","getWFSServiceMetadata","FeatureTypeList","FeatureType","map","aFeatureType","ogcFeatureValidation","_ref4","_callee3","keysSingleLayer","responseSingle","jsonSingle","keys","responseCollection","jsonCollection","_layers2","_context3","fetch","status","json","every","key","Object","id","title","collections","geocoreValidation","indexOf","replaceAll","esriValidation","_ref5","_callee4","esri","_layers3","_context4","getESRIServiceMetadata","capabilities","aLayer","_x","xyzValidation","tiles","dataAccessPath","source","geoJSONValidation","_ref6","_callee5","response","_context5","pop","replace","handleStep2","_ref7","_callee6","valid","_context6","undefined","handleStepLast","geoviewLayerId","generateId","LAYER","EVENT_LAYER_ADDED","getMapServerUrl","_layerURL$split3","layerConfig","geoviewLayerName","geoviewLayerType","metadataAccessPath","listOfLayerEntryConfig","getOGCServerUrl","setTimeout","layerOrder","subLayer","unshift","addGeoviewLayer","handleBack","prevActiveStep","handleFile","file","fileURL","URL","createObjectURL","fileName","handleNameLayer","target","handleDrop","_event$dataTransfer","preventDefault","stopPropagation","dataTransfer","files","upFilename","toUpperCase","endsWith","NavButtons","_ref8","_ref8$isFirst","isFirst","_ref8$isLast","isLast","handleNext","_jsx","sx","padding","children","_jsxs","variant","onClick","_Fragment","display","justifyContent","zIndex","color","position","top","orientation","steps","stepLabel","stepContent","className","style","onDrop","e","onDragOver","onDragEnter","current","onDragLeave","ref","backgroundColor","bottom","left","right","textAlign","fontSize","onChange","accept","_document$getElementB","document","getElementById","click","width","label","trim","multiline","layerTokens","parseInt","Number","isNaN","fullWidth","labelId","inputLabel","menuItems","_ref9","_ref10","item","multiple","disableClearable","options","getOptionLabel","option","renderOption","props","_objectSpread","newValue","x","renderInput","params","layerIds","setReorderLayersVisible","setMapLayers","List","ListItem","ListItemButton","ListItemIcon","HandleIcon","ListItemText","titleBar","draggableList","regularListItem","draggingListItem","background","listItemText","noWrap","handleIcon","margin","getLayerName","geoviewLayers","DragDropContext","onDragEnd","destination","reorderedLayerIds","_toConsumableArray","_reorderedLayerIds$sp","splice","index","removed","moveLayer","Droppable","droppableId","provided","droppableProps","innerref","innerRef","Draggable","draggableId","providedDrag","snapshotDrag","isDragging","draggableProps","dragHandleProps","primaryTypographyProps","primary","placeholder","buttonPanel","addLayerVisible","reorderLayersVisible","mapLayers","legend","setLegend","actionMenuAnchorElement","setActionMenuAnchorElement","isExpandAll","setExpandAll","isHideAll","setHideAll","AddIcon","ExpandMoreIcon","ExpandLessIcon","VisibilityIcon","VisibilityOffIcon","Menu","MenuItem","MenuIcon","ReorderIcon","toJsonObject","addLayer","expandAll","collapseAll","showAll","hideAll","reorderLayers","mainContainer","flexDirection","height","topControls","addLayerSection","alignItems","marginTop","actionMenuOpen","Boolean","updateLayers","_api$maps$mapId$layer","reverse","MAP","EVENT_MAP_LOADED","GET_LEGENDS","LEGENDS_LAYERSET_UPDATED","createLegend","isRemoveable","canSetOpacity","canZoomTo","setAddLayerVisibleListenerFunction","PANEL","EVENT_PANEL_CLOSE","buttonPanelId","handleCloseMenu","handleExpandAllClick","isExpand","handleShowAllClick","isShow","scrollX","y","scrollY","onscroll","scrollTo","anchorEl","open","onClose","LayerStepper","ReorderLayersList","currentTarget","state","LayersPanelPlugin","_AbstractPlugin","_inherits","_super","_createSuper","pluginId","_this","_classCallCheck","call","_defineProperty","_assertThisInitialized","schema","defaultConfig","layersPanel","_createClass","_configObj","_this$buttonPanel","panelStatus","this","pluginProps","LayersOutlinedIcon","configObj","isOpen","large","button","tooltip","tooltipPlacement","visible","panel","icon","appBarButtons","createAppbarPanel","changeContent","PanelContent","removeAppbarPanel","AbstractPlugin","plugins","Cast"],"sourceRoot":""}