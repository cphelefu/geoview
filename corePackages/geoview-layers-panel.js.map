{"version":3,"file":"corePackages/geoview-layers-panel.js","mappings":"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","sources":["webpack://geoview-core/./src/api/plugin/abstract-plugin.ts","webpack://geoview-core/./src/api/plugin/appbar-plugin.ts","webpack://geoview-core/../geoview-layers-panel/src/layer-stepper.tsx","webpack://geoview-core/../geoview-layers-panel/src/reorder-layers-list.tsx","webpack://geoview-core/../geoview-layers-panel/src/panel-content.tsx","webpack://geoview-core/../geoview-layers-panel/src/index.tsx"],"sourcesContent":["import React from 'react';\nimport i18next from 'react-i18next';\n\nimport { useTheme } from '@mui/material/styles';\nimport { API } from '@/api/api';\nimport { MapViewer } from '@/geo/map/map-viewer';\nimport { TypeWindow, TypeJsonObject } from '@/core/types/global-types';\nimport { logger } from '@/core/utils/logger';\n\n/** ******************************************************************************************************************************\n * interface used by all plugins to define their options.\n */\nexport type TypePluginOptions = {\n  mapId: string;\n};\n\n/** ******************************************************************************************************************************\n * Plugin abstract base class.\n */\nexport abstract class AbstractPlugin {\n  // Id of the plugin\n  pluginId: string;\n\n  // Plugin properties\n  pluginProps: TypePluginOptions;\n\n  // NOTE START !! ****************************************************************************************************\n  // The following attributes are attached, after instantiation, by the plugin loader addPlugin function ref 'Object.defineProperties'(!)\n  // In this refactoring at the time of coding, I'm, simply, explicitely, writing them here so it's clear that this AbstractPlugin class has (and expects) those attributes.\n  // See plugin.addPlugin function for more details.\n\n  // Plugin config object\n  configObj?: TypeJsonObject;\n\n  // Plugin api object\n  api?: API;\n\n  // Plugin react object\n  react?: typeof React;\n\n  // Plugin translate object\n  // TODO: Refactor - Plugin - Maybe translate is not necessary here.. This might get removed eventually. Don't forget to remove in plugin class too in 'Object.defineProperties'(!)\n  translate?: typeof i18next;\n\n  // Plugin useTheme object\n  // TODO: Refactor - Plugin - Maybe useTheme is not necessary here.. This might get removed eventually. Don't forget to remove in plugin class too in 'Object.defineProperties'(!)\n  useTheme?: typeof useTheme;\n\n  // NOTE END !! ******************************************************************************************************\n\n  /**\n   * Constructs a Plugin\n   * @param pluginId string The plugin id\n   * @param props TypePluginOptions The plugin configuration options\n   */\n  constructor(pluginId: string, props: TypePluginOptions) {\n    this.pluginId = pluginId;\n    this.pluginProps = props;\n  }\n\n  /**\n   * Returns the MapViewer used by this Plugin\n   * @returns MapViewer The MapViewer used by this Plugin\n   */\n  map(): MapViewer | undefined {\n    return this.api?.maps[this.pluginProps.mapId];\n  }\n\n  /**\n   * Returns the language currently used by the 'translate' i18next component used by this Plugin\n   * @returns string The language, 'en' (English) by default.\n   */\n  displayLanguage(): string {\n    return this.translate?.getI18n().language || 'en';\n  }\n\n  /**\n   * Override this to do the actual adding\n   */\n  abstract onAdd(): void;\n\n  /**\n   * Optionally override this to do something when done adding\n   */\n  onAdded?(): void;\n\n  /**\n   * Override this to do the actual removal\n   */\n  abstract onRemove(): void;\n\n  /**\n   * Optionally override this to do something when done being removed\n   */\n  onRemoved?(): void;\n\n  /**\n   * This function is called when the plugin is added, used for finalizing initialization. See plugin.addPlugin for details.\n   */\n  added(): void {\n    // Fetch cgpv\n    const { cgpv } = window as TypeWindow;\n\n    // If cgpv\n    if (cgpv) {\n      // Log\n      logger.logInfo(`Plugin ${this.pluginId} loaded, adding it on map ${this.pluginProps.mapId}`);\n\n      // Add\n      this.onAdd();\n\n      // Added\n      this.onAdded?.();\n\n      // Log\n      logger.logInfo(`Plugin ${this.pluginId} loaded, and added to map ${this.pluginProps.mapId}`);\n    }\n  }\n\n  /**\n   * This function is called when the plugin is removed, used for clean up. See plugin.addPlugin for details.\n   */\n  removed(): void {\n    // Fetch cgpv\n    const { cgpv } = window as TypeWindow;\n\n    // If cgpv\n    if (cgpv) {\n      // Log\n      logger.logInfo(`Plugin ${this.pluginId} being removed from map ${this.pluginProps.mapId}`);\n\n      // Remove\n      this.onRemove();\n\n      // Removed\n      this.onRemoved?.();\n\n      // Log\n      logger.logInfo(`Plugin ${this.pluginId} removed from map ${this.pluginProps.mapId}`);\n    }\n  }\n}\n","import { TypeButtonPanel, TypePanelProps } from '@/ui/panel/panel-types';\nimport { AbstractPlugin } from './abstract-plugin';\nimport { TypeWindow } from '@/core/types/global-types';\nimport { TypeIconButtonProps } from '@/ui/icon-button/icon-button-types';\n\n/** ******************************************************************************************************************************\n * AppBar Plugin abstract class.\n */\nexport abstract class AppBarPlugin extends AbstractPlugin {\n  // Store the created button panel object\n  buttonPanel?: TypeButtonPanel;\n\n  // Store the button props\n  buttonProps?: TypeIconButtonProps;\n\n  // Store the panel props\n  panelProps?: TypePanelProps;\n\n  /**\n   * Overridable function to create app bar button props content\n   * @returns TypeIconButtonProps The app bar button props content\n   */\n  onCreateButtonProps(): TypeIconButtonProps {\n    // Override this to create the button props..\n\n    // Fetch cgpv\n    const { cgpv } = window as TypeWindow;\n    const { MapIcon } = cgpv.ui.elements;\n\n    // Return dummy plugin button\n    return {\n      id: 'somePluginButton',\n      tooltip: 'Some tooltip',\n      tooltipPlacement: 'right',\n      children: this.react!.createElement(MapIcon),\n      visible: true,\n    };\n  }\n\n  /**\n   * Overridable function to create app bar props content\n   * @returns TypePanelProps The app bar props content\n   */\n  onCreateContentProps(): TypePanelProps {\n    // Override this to create the panel props..\n\n    // Panel props\n    return {\n      title: 'Some title',\n      icon: '<i class=\"material-icons\">map</i>',\n      width: '80vw',\n      status: this.configObj?.isOpen as boolean,\n    };\n  }\n\n  /**\n   * Overridable function to create app bar actual content\n   * @returns JSX.Element The app bar actual content\n   */\n  onCreateContent(): JSX.Element {\n    // Override this to create panel..\n\n    // Return dummy content\n    return this.react!.createElement('div', undefined, `Content for AppBar Plugin on map id ${this.pluginProps.mapId} goes here...`);\n  }\n\n  /**\n   * Called when an app bar plugin is being added\n   */\n  onAdd(): void {\n    // Create button props\n    this.buttonProps = this.onCreateButtonProps();\n\n    // Create panel props\n    this.panelProps = this.onCreateContentProps();\n\n    // Create content\n    this.panelProps.content = this.onCreateContent();\n\n    // Create a new button panel on the app-bar\n    this.buttonPanel = this.map()?.appBarApi.createAppbarPanel(this.buttonProps!, this.panelProps, null) || undefined;\n  }\n\n  /**\n   * Called when an app bar plugin is being removed\n   */\n  onRemove(): void {\n    // If cgpv exists\n    if (this.api && this.buttonPanel) {\n      // Remove the app bar panel\n      this.map()?.appBarApi.removeAppbarPanel(this.buttonPanel.buttonPanelId);\n    }\n  }\n}\n","/* eslint-disable react/require-default-props */\nimport type React from 'react';\nimport {\n  TypeJsonArray,\n  TypeGeoviewLayerConfig,\n  TypeGeoviewLayerType,\n  SelectChangeEvent,\n  ButtonPropsLayerPanel,\n  TypeListOfLayerEntryConfig,\n  TypeLayerEntryConfig,\n  TypeJsonObject,\n} from 'geoview-core';\nimport { logger } from 'geoview-core/src/core/utils/logger';\n\ntype Event = { target: { value: string } };\n\ninterface Props {\n  mapId: string;\n  setAddLayerVisible: (isVisible: boolean) => void;\n}\n\ntype EsriOptions = {\n  err: string;\n  capability: string;\n};\n\n/**\n * A react component that displays the details panel content\n *\n * @returns {JSX.Element} A React JSX Element with the details panel\n */\nfunction LayerStepper({ mapId, setAddLayerVisible }: Props): JSX.Element {\n  const { cgpv } = window;\n  const { api, ui, react } = cgpv;\n  const displayLanguage = api.maps[mapId].getDisplayLanguage() as 'en' | 'fr';\n\n  const { ESRI_DYNAMIC, ESRI_FEATURE, GEOJSON, GEOPACKAGE, WMS, WFS, OGC_FEATURE, XYZ_TILES, GEOCORE } = api.layerTypes;\n  const { useState, useRef } = react;\n  const {\n    Select,\n    Stepper,\n    TextField,\n    Button,\n    ButtonGroup,\n    Autocomplete,\n    CircularProgressBase,\n    Box,\n    IconButton,\n    CloseIcon,\n    FileUploadIcon,\n  } = ui.elements;\n\n  const [activeStep, setActiveStep] = useState(0);\n  const [layerURL, setLayerURL] = useState('');\n  const [displayURL, setDisplayURL] = useState('');\n  const [layerType, setLayerType] = useState<TypeGeoviewLayerType | ''>('');\n  const [layerList, setLayerList] = useState<TypeJsonArray[]>([]);\n  const [layerName, setLayerName] = useState('');\n  const [layerEntries, setLayerEntries] = useState<TypeListOfLayerEntryConfig>([]);\n  const [isLoading, setIsLoading] = useState<boolean>(false);\n  const [drag, setDrag] = useState<boolean>(false);\n\n  const dragPopover = useRef(null);\n\n  const sxClasses = {\n    buttonGroup: {\n      paddingTop: 12,\n      gap: 6,\n    },\n  };\n\n  const isMultiple = () => layerType === ESRI_DYNAMIC || layerType === WFS || layerType === WMS;\n\n  /**\n   * List of layer types and labels\n   */\n  const layerOptions = [\n    [ESRI_DYNAMIC, 'ESRI Dynamic Service'],\n    [ESRI_FEATURE, 'ESRI Feature Service'],\n    [GEOJSON, 'GeoJSON'],\n    [GEOPACKAGE, 'GeoPackage'],\n    [WMS, 'OGC Web Map Service (WMS)'],\n    [WFS, 'OGC Web Feature Service (WFS)'],\n    [OGC_FEATURE, 'OGC API Features'],\n    [XYZ_TILES, 'XYZ Raster Tiles'],\n    [GEOCORE, 'GeoCore'],\n  ];\n\n  /**\n   * Translations object to inject to the viewer translations\n   */\n  const translations = {\n    en: {\n      finish: 'Finish',\n      continue: 'Continue',\n      back: 'Back',\n      or: 'or',\n      dropzone: 'Drop Here',\n      upload: 'Choose a File',\n      drop: 'Drop the file to upload',\n      url: 'Enter URL or UUID',\n      layer: 'Layer',\n      stepOne: 'Upload a File or enter URL/UUID',\n      stepTwo: 'Select format',\n      stepThree: 'Configure layer',\n      stepFour: 'Enter Name',\n      service: 'Service Type',\n      name: 'Name',\n      layerSelect: 'Select Layer',\n      errorEmpty: 'cannot be empty',\n      errorNone: 'No file or source added',\n      errorFile: 'Only geoJSON and GeoPackage files can be used',\n      errorServer: 'source is not valid',\n      errorProj: 'does not support current map projection',\n      only: 'only',\n    },\n    fr: {\n      finish: 'Finir',\n      continue: 'Continuer',\n      back: 'Retour',\n      or: 'ou',\n      dropzone: 'Déposez ici',\n      upload: 'Choisir un fichier',\n      drop: 'Déposez le fichier à télécharger',\n      url: \"Entrer l'URL ou l'UUID\",\n      layer: 'Couche',\n      stepOne: \"Ajouter un fichier ou entrer l'URL/UUID\",\n      stepTwo: 'Sélectionnez le format',\n      stepThree: 'Configurer la couche',\n      stepFour: 'Entrez le nom',\n      service: 'Type de service',\n      name: 'Nom',\n      layerSelect: 'Sélectionner la couche',\n      errorEmpty: 'ne peut être vide',\n      errorNone: 'Pas de fichier ou de source ajouté',\n      errorFile: 'Seuls les fichiers geoJSON et GeoPackage peuvent être utilisés',\n      errorServer: \"source n'est pas valide\",\n      errorProj: 'ne prend pas en charge la projection cartographique actuelle',\n      only: 'seulement',\n    },\n  };\n\n  /**\n   * Returns the appropriate error config for ESRI layer types\n   *\n   * @param type one of esriDynamic or esriFeature\n   * @returns {EsriOptions} an error configuration object for populating dialogues\n   */\n  const esriOptions = (type: string): EsriOptions => {\n    switch (type) {\n      case ESRI_DYNAMIC:\n        return { err: 'ESRI Map', capability: 'Map' };\n      case ESRI_FEATURE:\n        return { err: 'ESRI Feature', capability: 'Query' };\n      default:\n        return { err: '', capability: '' };\n    }\n  };\n\n  /**\n   * Emits an error dialogue when a text field is empty\n   *\n   * @param textField label for the TextField input that cannot be empty\n   */\n  const emitErrorEmpty = (textField: string) => {\n    setIsLoading(false);\n    api.utilities.showError(mapId, `${textField} ${translations[displayLanguage].errorEmpty}`, false);\n  };\n\n  /**\n   * Emits an error dialogue when a text field is empty\n   *\n   * @param textField label for the TextField input that cannot be empty\n   */\n  const emitErrorNone = () => {\n    setIsLoading(false);\n    api.utilities.showError(mapId, translations[displayLanguage].errorNone, false);\n  };\n\n  /**\n   * Emits an error dialogue when unsupported files are uploaded\n   *\n   * @param textField label for the TextField input that cannot be empty\n   */\n  const emitErrorFile = () => {\n    api.utilities.showError(mapId, translations[displayLanguage].errorFile, false);\n  };\n\n  /**\n   * Emits an error when the URL does not support the selected service type\n   *\n   * @param serviceName type of service provided by the URL\n   */\n  const emitErrorServer = (serviceName: string) => {\n    setIsLoading(false);\n    api.utilities.showError(mapId, `${serviceName} ${translations[displayLanguage].errorServer}`, false);\n  };\n\n  /**\n   * Emits an error when a service does not support the current map projection\n   *\n   * @param serviceName type of service provided by the URL\n   * @param proj current map projection\n   */\n  const emitErrorProj = (serviceName: string, proj: string | undefined, supportedProj: TypeJsonArray | string[]) => {\n    setIsLoading(false);\n    const message = `${serviceName} ${translations[displayLanguage].errorProj} ${proj}, ${\n      translations[displayLanguage].only\n    } ${supportedProj.join(', ')}`;\n    api.utilities.showError(mapId, message, false);\n  };\n\n  /**\n   * Using the layerURL state object, check whether URL is a valid WMS,\n   * and add either Name and Entry directly to state if a single layer,\n   * or a list of Names / Entries if multiple layer options exist.\n   *\n   * @returns {Promise<boolean>} True if layer passes validation\n   */\n  const wmsValidation = async (): Promise<boolean> => {\n    const proj = api.projection.projections[api.maps[mapId].getMapState().currentProjection].getCode();\n    let supportedProj: string[] = [];\n\n    try {\n      const [baseUrl, queryString] = layerURL.split('?');\n      const urlParams = new URLSearchParams(queryString);\n      const paramLayers = urlParams.get('layers')?.split(',') || [''];\n      // query layers are not sent, as not all services support asking for multiple layers\n      const wms = await api.geoUtilities.getWMSServiceMetadata(baseUrl, '');\n\n      supportedProj = wms.Capability.Layer.CRS as string[];\n      if (!supportedProj.includes(proj)) throw new Error('proj');\n\n      const layers: TypeJsonArray[] = [];\n\n      const hasChildLayers = (layer: TypeJsonObject) => {\n        if (layer.Layer && (layer.Layer as TypeJsonArray).length > 0) {\n          (layer.Layer as TypeJsonObject[]).forEach((childLayer: TypeJsonObject) => {\n            hasChildLayers(childLayer);\n          });\n        } else {\n          for (let i = 0; i < paramLayers.length; i++) {\n            if ((layer.Name as string) === paramLayers[i]) layers.push([layer.Name, layer.Title] as TypeJsonArray);\n          }\n        }\n      };\n\n      if (wms.Capability.Layer) {\n        hasChildLayers(wms.Capability.Layer);\n      }\n\n      if (layers.length === 1) {\n        setLayerName(layers[0][1] as string);\n        setLayerEntries([\n          {\n            layerId: layers[0][0] as string,\n          },\n        ] as TypeListOfLayerEntryConfig);\n      } else {\n        setLayerList(layers);\n      }\n    } catch (err) {\n      if ((err as Error).message === 'proj') {\n        emitErrorProj('WMS', proj, supportedProj);\n      } else {\n        emitErrorServer('WMS');\n      }\n      return false;\n    }\n    return true;\n  };\n\n  /**\n   * Using the layerURL state object, check whether URL is a valid WFS,\n   * and add either Name and Entry directly to state if a single layer,\n   * or a list of Names / Entries if multiple layer options exist.\n   *\n   * @returns {Promise<boolean>} True if layer passes validation\n   */\n  const wfsValidation = async (): Promise<boolean> => {\n    try {\n      const wfs = await api.geoUtilities.getWFSServiceMetadata(layerURL);\n      const layers = (wfs.FeatureTypeList.FeatureType as TypeJsonArray).map((aFeatureType) => [\n        (aFeatureType.Name['#text'] as string).split(':')[1] as TypeJsonObject,\n        aFeatureType.Title['#text'],\n      ]);\n      if (layers.length === 1) {\n        setLayerName(layers[0][1] as string);\n        setLayerEntries([\n          {\n            layerId: layers[0][0] as string,\n          },\n        ] as TypeListOfLayerEntryConfig);\n      } else {\n        setLayerList(layers);\n      }\n    } catch (err) {\n      emitErrorServer('WFS');\n      return false;\n    }\n    return true;\n  };\n\n  /**\n   * Using the layerURL state object, check whether URL is a valid OGC API. You can either provide a single\n   * layer URL or the root OGC API where the user can select any number of layers in the collection\n   *\n   * @returns {Promise<boolean>} True if layer passes validation\n   */\n  const ogcFeatureValidation = async (): Promise<boolean> => {\n    const keysSingleLayer = ['id', 'title'];\n    const responseSingle = await fetch(`${layerURL}/?f=json`);\n    if (responseSingle.status !== 200) {\n      emitErrorServer('OGC API Feature');\n      return false;\n    }\n    const jsonSingle = await responseSingle.json();\n    const isSingleLayerValid = keysSingleLayer.every((key) => Object.keys(jsonSingle).includes(key));\n    if (isSingleLayerValid) {\n      setLayerEntries([\n        {\n          layerId: jsonSingle.id,\n        },\n      ] as TypeListOfLayerEntryConfig);\n      setLayerName(jsonSingle.title);\n      return true;\n    }\n\n    try {\n      const keys = ['collections', 'links'];\n      const responseCollection = await fetch(`${layerURL}/collections?f=json`);\n      const jsonCollection = await responseCollection.json();\n      const isCollectionValid = keys.every((key) => Object.keys(jsonCollection).includes(key));\n      if (!isCollectionValid) throw new Error('err');\n      const layers = (jsonCollection.collections as TypeJsonArray).map((aFeatureType) => [aFeatureType.id, aFeatureType.title]);\n      if (layers.length === 1) {\n        setLayerName(layers[0][1] as string);\n        setLayerEntries([\n          {\n            layerId: layers[0][0] as string,\n          },\n        ] as TypeListOfLayerEntryConfig);\n      } else {\n        setLayerList(layers);\n      }\n    } catch (err) {\n      emitErrorServer('OGC API Feature');\n      return false;\n    }\n    return true;\n  };\n\n  /**\n   * Using the layerURL state object, check whether URL is a valid Geocore UUID.\n   *\n   * @returns {Promise<boolean>} True if layer passes validation\n   */\n  const geocoreValidation = (): boolean => {\n    try {\n      const isValid = layerURL.indexOf('/') === -1 && layerURL.replaceAll('-', '').length === 32;\n      if (!isValid) throw new Error('err');\n      setLayerName('');\n      setLayerEntries([\n        {\n          layerId: layerURL,\n        },\n      ] as TypeListOfLayerEntryConfig);\n    } catch (err) {\n      emitErrorServer('GeoCore UUID');\n      return false;\n    }\n    return true;\n  };\n\n  /**\n   * Using the layerURL state object, check whether URL is a valid ESRI Server,\n   * and add either Name and Entry directly to state if a single layer,\n   * or a list of Names / Entries if multiple layer options exist.\n   *\n   * @returns {Promise<boolean>} True if layer passes validation\n   */\n  const esriValidation = async (type: string): Promise<boolean> => {\n    try {\n      const esri = await api.geoUtilities.getESRIServiceMetadata(layerURL);\n      if ((esri.capabilities as string).includes(esriOptions(type).capability)) {\n        if ('layers' in esri) {\n          const layers = (esri.layers as TypeJsonArray).map((aLayer) => [aLayer.id, aLayer.name]);\n          if (layers.length === 1) {\n            setLayerName(layers[0][1] as string);\n            setLayerEntries([\n              {\n                layerId: layers[0][0] as string,\n              },\n            ] as TypeListOfLayerEntryConfig);\n          } else {\n            setLayerList(layers);\n          }\n        } else {\n          setLayerName(esri.name as string);\n          setLayerEntries([\n            {\n              layerId: esri.id as string,\n            },\n          ] as TypeListOfLayerEntryConfig);\n        }\n      } else {\n        throw new Error('err');\n      }\n    } catch (err) {\n      emitErrorServer(esriOptions(type).err);\n      return false;\n    }\n    return true;\n  };\n\n  /**\n   * Using the layerURL state object, check whether URL is a valid XYZ Server.\n   *\n   * @returns {boolean} True if layer passes validation\n   */\n  const xyzValidation = (): boolean => {\n    const tiles = ['{x}', '{y}', '{z}'];\n    for (let i = 0; i < tiles.length; i += 1) {\n      if (!layerURL.includes(tiles[i])) {\n        emitErrorServer('XYZ Tile');\n        return false;\n      }\n    }\n    const dataAccessPath = layerURL;\n    setLayerName('');\n    setLayerEntries([\n      {\n        layerId: layerURL,\n        source: {\n          dataAccessPath: {\n            en: dataAccessPath,\n            fr: dataAccessPath,\n          },\n        },\n      },\n    ] as TypeListOfLayerEntryConfig);\n    return true;\n  };\n\n  /**\n   * Using the layerURL state object, check whether URL is a valid GeoJSON.\n   *\n   * @returns {Promise<boolean>} True if layer passes validation\n   */\n  const geoJSONValidation = async (): Promise<boolean> => {\n    try {\n      const response = await fetch(layerURL);\n      const json = await response.json();\n      if (!['FeatureCollection', 'Feature'].includes(json.type)) {\n        throw new Error('err');\n      }\n      const layerId = layerURL.split('/').pop() as string;\n      const dataAccessPath = layerURL.replace(layerId, '');\n      if (!layerName) setLayerName(layerId);\n      setLayerEntries([\n        {\n          layerId,\n          source: {\n            dataAccessPath: {\n              en: dataAccessPath,\n              fr: dataAccessPath,\n            },\n          },\n        },\n      ] as TypeListOfLayerEntryConfig);\n    } catch (err) {\n      emitErrorServer('GeoJSON');\n      return false;\n    }\n    return true;\n  };\n\n  /**\n   * Using the layerURL state object, check whether URL is a valid GeoPackage.\n   *\n   * @returns {Promise<boolean>} True if layer passes validation\n   */\n  const geoPackageValidation = (): boolean => {\n    // TODO actual geopackage validation\n    const layerId = layerURL.split('/').pop() as string;\n    const dataAccessPath = layerURL.replace(layerId, '');\n    if (!layerName) setLayerName(layerId);\n    setLayerEntries([\n      {\n        layerId,\n        source: {\n          dataAccessPath: {\n            en: dataAccessPath,\n            fr: dataAccessPath,\n          },\n        },\n      },\n    ] as TypeListOfLayerEntryConfig);\n    return true;\n  };\n\n  /**\n   * Attempt to determine the layer type based on the URL format\n   */\n  const bestGuessLayerType = () => {\n    const layerTokens = displayURL.toUpperCase().split('/');\n    const layerId = parseInt(layerTokens[layerTokens.length - 1], 10);\n    if (displayURL.toUpperCase().endsWith('MAPSERVER') || displayURL.toUpperCase().endsWith('MAPSERVER/')) {\n      setLayerType(ESRI_DYNAMIC);\n    } else if (\n      displayURL.toUpperCase().indexOf('FEATURESERVER') !== -1 ||\n      (displayURL.toUpperCase().indexOf('MAPSERVER') !== -1 && !Number.isNaN(layerId))\n    ) {\n      setLayerType(ESRI_FEATURE);\n    } else if (layerTokens.indexOf('WFS') !== -1) {\n      setLayerType(WFS);\n    } else if (displayURL.toUpperCase().endsWith('.JSON') || displayURL.toUpperCase().endsWith('.GEOJSON')) {\n      setLayerType(GEOJSON);\n    } else if (displayURL.toUpperCase().endsWith('.GPKG')) {\n      setLayerType(GEOPACKAGE);\n    } else if (displayURL.toUpperCase().indexOf('{Z}/{X}/{Y}') !== -1 || displayURL.toUpperCase().indexOf('{Z}/{Y}/{X}') !== -1) {\n      setLayerType(XYZ_TILES);\n    } else if (displayURL.indexOf('/') === -1 && displayURL.replaceAll('-', '').length === 32) {\n      setLayerType(GEOCORE);\n    } else if (displayURL.toUpperCase().indexOf('WMS') !== -1) {\n      setLayerType(WMS);\n    }\n  };\n\n  /**\n   * Handle the behavior of the 'Continue' button in the Stepper UI\n   */\n  const handleStep1 = () => {\n    let valid = true;\n    if (layerURL.trim() === '') {\n      valid = false;\n      emitErrorNone();\n    }\n    if (valid) {\n      bestGuessLayerType();\n      setActiveStep(1);\n    }\n  };\n\n  /**\n   * Handle the behavior of the 'Continue' button in the Stepper UI\n   */\n  const handleStep2 = async () => {\n    setIsLoading(true);\n    let valid = true;\n    if (layerType === undefined) {\n      valid = false;\n      setIsLoading(false);\n      emitErrorEmpty(translations[displayLanguage].service);\n    } else if (layerType === WMS) valid = await wmsValidation();\n    else if (layerType === WFS) valid = await wfsValidation();\n    else if (layerType === OGC_FEATURE) valid = await ogcFeatureValidation();\n    else if (layerType === XYZ_TILES) valid = xyzValidation();\n    else if (layerType === ESRI_DYNAMIC) valid = await esriValidation(ESRI_DYNAMIC);\n    else if (layerType === ESRI_FEATURE) valid = await esriValidation(ESRI_FEATURE);\n    else if (layerType === GEOJSON) valid = await geoJSONValidation();\n    else if (layerType === GEOPACKAGE) valid = geoPackageValidation();\n    else if (layerType === GEOCORE) valid = geocoreValidation();\n    if (valid) {\n      setIsLoading(false);\n      setActiveStep(2);\n    }\n  };\n\n  /**\n   * Handle the behavior of the 'Finish' button in the Stepper UI\n   */\n  const handleStep3 = () => {\n    let valid = true;\n    if (layerEntries.length === 0) {\n      valid = false;\n      emitErrorEmpty(translations[displayLanguage].layer);\n    }\n    if (valid) setActiveStep(3);\n  };\n\n  /**\n   * Handle the behavior of the 'Finish' button in the Stepper UI\n   */\n  const handleStepLast = () => {\n    setIsLoading(true);\n    const geoviewLayerId = api.generateId();\n    api.event.on(\n      api.eventNames.LAYER.EVENT_LAYER_ADDED,\n      () => {\n        // Log\n        logger.logTraceCoreAPIEvent('LAYER-STEPPER - EVENT_LAYER_ADDED');\n\n        api.event.off(api.eventNames.LAYER.EVENT_LAYER_ADDED, mapId);\n        setIsLoading(false);\n        setAddLayerVisible(false);\n      },\n      `${mapId}/${geoviewLayerId}`\n    );\n\n    let valid = true;\n    const name = layerName;\n    let url = layerURL;\n    if (layerType === ESRI_DYNAMIC || layerType === ESRI_FEATURE) {\n      url = api.geoUtilities.getMapServerUrl(layerURL);\n    }\n    if (layerType === WMS) {\n      [url] = layerURL.split('?');\n    }\n\n    if (layerName === '') {\n      valid = false;\n      emitErrorEmpty(isMultiple() ? translations[displayLanguage].layer : translations[displayLanguage].name);\n    }\n    const layerConfig: TypeGeoviewLayerConfig = {\n      geoviewLayerId,\n      geoviewLayerName: {\n        en: name,\n        fr: name,\n      },\n      geoviewLayerType: layerType as TypeGeoviewLayerType,\n      metadataAccessPath: {\n        en: url,\n        fr: url,\n      },\n      listOfLayerEntryConfig: layerEntries as TypeListOfLayerEntryConfig,\n    };\n\n    if (layerType === GEOJSON || layerType === XYZ_TILES || layerType === GEOPACKAGE) {\n      // TODO probably want an option to add metadata if geojson or geopackage\n      // need to clear our metadata path or it will give errors trying to find it\n      layerConfig.metadataAccessPath = {\n        en: '',\n        fr: '',\n      };\n    }\n    if (layerType === GEOCORE) {\n      delete layerConfig.metadataAccessPath;\n    }\n    if (layerType === OGC_FEATURE) {\n      // make sure the metadataAccessPath is the root OGC API URL\n      layerConfig.metadataAccessPath = {\n        en: api.geoUtilities.getOGCServerUrl(layerURL),\n        fr: api.geoUtilities.getOGCServerUrl(layerURL),\n      };\n    }\n    if (valid) {\n      // TODO issue #668 - geocore layers do not have same ID, it is impossible to use the added event\n      // workaround - close after 3 sec\n      if (layerType === GEOCORE) {\n        setTimeout(() => {\n          setIsLoading(false);\n          setAddLayerVisible(false);\n        }, 3000);\n      }\n\n      if (layerConfig.geoviewLayerId) {\n        api.maps[mapId].layer.layerOrder.push(layerConfig.geoviewLayerId);\n      } else if (layerConfig.listOfLayerEntryConfig !== undefined) {\n        layerConfig.listOfLayerEntryConfig.forEach((subLayer: TypeLayerEntryConfig) => {\n          if (subLayer.layerId) api.maps[mapId].layer.layerOrder.unshift(subLayer.layerId);\n        });\n      }\n\n      api.maps[mapId].layer.addGeoviewLayer(layerConfig);\n    }\n  };\n\n  /**\n   * Handle the behavior of the 'Back' button in the Stepper UI\n   */\n  const handleBack = () => {\n    setActiveStep((prevActiveStep: number) => prevActiveStep - 1);\n  };\n\n  /**\n   * Set layer URL from file input\n   *\n   * @param {File} file uploaded file\n   */\n  const handleFile = (file: File) => {\n    const fileURL = URL.createObjectURL(file);\n    setDisplayURL(file.name);\n    setLayerURL(fileURL);\n    const fileName = file.name.split('.')[0];\n    setLayerType('');\n    setLayerList([]);\n    setLayerName(fileName);\n    setLayerEntries([]);\n  };\n\n  /**\n   * Set layer URL from form input\n   *\n   * @param e TextField event\n   */\n  const handleInput = (event: Event) => {\n    setDisplayURL(event.target.value.trim());\n    setLayerURL(event.target.value.trim());\n    setLayerType('');\n    setLayerList([]);\n    setLayerName('');\n    setLayerEntries([]);\n  };\n\n  /**\n   * Set layerType from form input\n   *\n   * @param {SelectChangeEvent} event TextField event\n   */\n  const handleSelectType = (event: SelectChangeEvent<unknown>) => {\n    setLayerType(event.target.value as TypeGeoviewLayerType);\n    setLayerList([]);\n    setLayerEntries([]);\n  };\n\n  /**\n   * Set the currently selected layer from a list\n   *\n   * @param event Select event\n   * @param newValue value/label pairs of select options\n   */\n  const handleSelectLayer = (event: Event, newValue: string[]) => {\n    if (isMultiple()) {\n      setLayerEntries(\n        newValue.map((x: string) => {\n          return { layerId: `${x[0]}` };\n        }) as TypeListOfLayerEntryConfig\n      );\n      setLayerName(newValue.map((x) => x[1]).join(', '));\n    } else {\n      setLayerEntries([{ layerId: `${newValue[0]}` }] as TypeListOfLayerEntryConfig);\n      setLayerName(newValue[1]);\n    }\n  };\n\n  /**\n   * Set the layer name from form input\n   *\n   * @param e TextField event\n   */\n  const handleNameLayer = (event: Event) => {\n    setLayerName(event.target.value);\n  };\n\n  /**\n   * Handle file dragged into dropzone\n   *\n   * @param {DragEvent<HTMLDivElement>} event Drag event\n   */\n  const handleDragEnter = (event: React.DragEvent<HTMLDivElement>) => {\n    event.preventDefault();\n    event.stopPropagation();\n    if (event.target !== dragPopover.current) {\n      setDrag(true);\n    }\n  };\n\n  /**\n   * Handle file dragged out of dropzone\n   *\n   * @param {DragEvent<HTMLDivElement>} event Drag event\n   */\n  const handleDragLeave = (event: React.DragEvent<HTMLDivElement>) => {\n    event.preventDefault();\n    event.stopPropagation();\n    if (event.target === dragPopover.current) setDrag(false);\n  };\n\n  /**\n   * Prevent default behaviour when file dragged over dropzone\n   *\n   * @param {DragEvent<HTMLDivElement>} event Drag event\n   */\n  const handleDragOver = (event: React.DragEvent<HTMLDivElement>) => {\n    event.preventDefault();\n    event.stopPropagation();\n  };\n\n  /**\n   * Handle file drop\n   *\n   * @param {DragEvent<HTMLDivElement>} event Drag event\n   */\n  const handleDrop = (event: React.DragEvent<HTMLDivElement>) => {\n    event.preventDefault();\n    event.stopPropagation();\n    setDrag(false);\n    if (event.dataTransfer?.files) {\n      const file = event.dataTransfer.files[0];\n      const upFilename = file.name.toUpperCase();\n      if (upFilename.endsWith('.JSON') || upFilename.endsWith('.GEOJSON') || upFilename.endsWith('.GPKG') || upFilename.endsWith('.CSV')) {\n        handleFile(file);\n      } else {\n        emitErrorFile();\n      }\n    }\n  };\n\n  /**\n   * Creates a set of Continue / Back buttons\n   *\n   * @param param0 specify if button is first or last in the list\n   * @returns {JSX.Element} React component\n   */\n  // TODO: refactor - see if we can get rid of the unstable nested component\n  // eslint-disable-next-line react/no-unstable-nested-components\n  function NavButtons({ isFirst = false, isLast = false, handleNext }: ButtonPropsLayerPanel): JSX.Element {\n    return isLoading ? (\n      <Box sx={{ padding: 10 }}>\n        <CircularProgressBase />\n      </Box>\n    ) : (\n      <ButtonGroup sx={sxClasses.buttonGroup}>\n        <Button variant=\"contained\" type=\"text\" onClick={handleNext}>\n          {isLast ? translations[displayLanguage].finish : translations[displayLanguage].continue}\n        </Button>\n        {!isFirst && (\n          <Button variant=\"contained\" type=\"text\" onClick={handleBack}>\n            {translations[displayLanguage].back}\n          </Button>\n        )}\n      </ButtonGroup>\n    );\n  }\n\n  return (\n    <>\n      <Box sx={{ display: 'flex', justifyContent: 'end', zIndex: 2 }}>\n        <IconButton color=\"primary\" onClick={() => setAddLayerVisible(false)}>\n          <CloseIcon />\n        </IconButton>\n      </Box>\n      <Stepper\n        sx={{ position: 'relative', top: '-30px', zIndex: 1 }}\n        activeStep={activeStep}\n        orientation=\"vertical\"\n        steps={[\n          {\n            stepLabel: {\n              children: translations[displayLanguage].stepOne,\n            },\n            stepContent: {\n              children: (\n                <div\n                  className=\"dropzone\"\n                  style={{ position: 'relative' }}\n                  onDrop={(e) => handleDrop(e)}\n                  onDragOver={(e) => handleDragOver(e)}\n                  onDragEnter={(e) => handleDragEnter(e)}\n                  onDragLeave={(e) => handleDragLeave(e)}\n                >\n                  {drag && (\n                    <div\n                      ref={dragPopover}\n                      style={{\n                        backgroundColor: 'rgba(128,128,128,.95)',\n                        position: 'absolute',\n                        top: 0,\n                        bottom: 0,\n                        left: 0,\n                        right: 0,\n                        zIndex: 9999,\n                        textAlign: 'center',\n                        color: 'black',\n                        fontSize: 24,\n                      }}\n                    >\n                      <h3>\n                        <br />\n                        <br />\n                        {translations[displayLanguage].dropzone}\n                      </h3>\n                    </div>\n                  )}\n                  <div>\n                    <input\n                      type=\"file\"\n                      id=\"fileUpload\"\n                      style={{ display: 'none' }}\n                      onChange={(e) => {\n                        if (e.target.files) handleFile(e.target.files[0]);\n                      }}\n                      accept=\".gpkg, .json, .geojson, .csv\"\n                    />\n                  </div>\n                  <Button type=\"text\" onClick={() => document.getElementById('fileUpload')?.click()} className=\"\">\n                    <FileUploadIcon />\n                    <span>{translations[displayLanguage].upload}</span>\n                  </Button>\n                  <p style={{ textAlign: 'center' }}>\n                    <small>{translations[displayLanguage].drop}</small>\n                  </p>\n                  <p style={{ textAlign: 'center' }}>{translations[displayLanguage].or}</p>\n                  <TextField\n                    sx={{ width: '100%' }}\n                    label={translations[displayLanguage].url}\n                    variant=\"standard\"\n                    value={displayURL}\n                    onChange={handleInput}\n                    multiline\n                  />\n                  <br />\n                  <NavButtons isFirst handleNext={handleStep1} />\n                </div>\n              ),\n            },\n          },\n          {\n            stepLabel: {\n              children: translations[displayLanguage].stepTwo,\n            },\n            stepContent: {\n              children: (\n                <>\n                  <Select\n                    fullWidth\n                    labelId=\"service-type-label\"\n                    value={layerType}\n                    onChange={handleSelectType}\n                    label={translations[displayLanguage].service}\n                    inputLabel={{\n                      id: 'service-type-label',\n                    }}\n                    menuItems={layerOptions.map(([value, label]) => ({\n                      key: value,\n                      item: {\n                        value,\n                        children: label,\n                      },\n                    }))}\n                    variant=\"standard\"\n                  />\n                  <NavButtons handleNext={handleStep2} />\n                </>\n              ),\n            },\n          },\n          {\n            stepLabel: {\n              children: translations[displayLanguage].stepThree,\n            },\n            stepContent: {\n              children: (\n                <>\n                  {layerList.length === 0 && (\n                    <TextField label={translations[displayLanguage].name} variant=\"standard\" value={layerName} onChange={handleNameLayer} />\n                  )}\n                  {layerList.length > 1 && (\n                    <Autocomplete\n                      fullWidth\n                      multiple={isMultiple()}\n                      disableClearable={!isMultiple()}\n                      id=\"service-layer-label\"\n                      options={layerList}\n                      getOptionLabel={(option) => `${option[1]} (${option[0]})`}\n                      renderOption={(props, option) => <span {...props}>{option[1] as string}</span>}\n                      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                      onChange={handleSelectLayer as any}\n                      renderInput={(params) => <TextField {...params} label={translations[displayLanguage].layerSelect} />}\n                    />\n                  )}\n                  <br />\n                  <NavButtons isLast={!isMultiple()} handleNext={isMultiple() ? handleStep3 : handleStepLast} />\n                </>\n              ),\n            },\n          },\n          isMultiple()\n            ? {\n                stepLabel: {\n                  children: translations[displayLanguage].stepFour,\n                },\n                stepContent: {\n                  children: (\n                    <>\n                      <TextField\n                        sx={{ width: '100%' }}\n                        label={translations[displayLanguage].name}\n                        variant=\"standard\"\n                        value={layerName}\n                        onChange={handleNameLayer}\n                      />\n                      <br />\n                      <NavButtons isLast handleNext={handleStepLast} />\n                    </>\n                  ),\n                },\n              }\n            : null,\n        ]}\n      />\n    </>\n  );\n}\n\nexport default LayerStepper;\n","/* eslint-disable react/require-default-props */\nimport { DragDropContext, Draggable, Droppable, DropResult } from 'react-beautiful-dnd';\n\ninterface Props {\n  mapId: string;\n  title: string;\n  layerIds: string[];\n  setReorderLayersVisible: (isVisible: boolean) => void;\n  setMapLayers: (reorderedLayerIds: string[]) => void;\n}\n\n/**\n * A react component that displays the reorderable layers list\n *\n * @returns {JSX.Element} A React JSX Element with the reorderable layers list\n */\nfunction ReorderLayersList({ mapId, title, layerIds, setReorderLayersVisible, setMapLayers }: Props): JSX.Element {\n  const { cgpv } = window;\n  const { api, ui } = cgpv;\n\n  const { List, ListItem, ListItemButton, ListItemIcon, HandleIcon, ListItemText, Box, IconButton, CloseIcon } = ui.elements;\n\n  const { displayLanguage } = api.maps[mapId!];\n\n  const sxClasses = {\n    titleBar: {\n      position: 'relative',\n      top: '-30px',\n      zIndex: 1,\n    },\n    draggableList: {\n      top: '-30px',\n    },\n    regularListItem: {\n      color: 'text.primary',\n      padding: 0,\n    },\n    draggingListItem: {\n      color: 'text.primary',\n      padding: 0,\n      background: 'rgb(235,235,235,0.5)',\n    },\n    listItemText: {\n      fontSize: 14,\n      noWrap: true,\n    },\n    handleIcon: {\n      margin: '8px 0px',\n    },\n  };\n\n  const onDragEnd = ({ destination, source }: DropResult) => {\n    if (!destination) return; // dropped outside the list\n    const reorderedLayerIds = [...layerIds];\n    const [removed] = reorderedLayerIds.splice(source.index, 1);\n    reorderedLayerIds.splice(destination.index, 0, removed);\n    api.maps[mapId].layer.moveLayer(removed, destination.index);\n    setMapLayers(reorderedLayerIds);\n  };\n\n  const getLayerName = (layerId: string) => {\n    return api.maps[mapId].layer.geoviewLayers[layerId].geoviewLayerName[displayLanguage];\n  };\n\n  return (\n    <>\n      <Box sx={{ display: 'flex', justifyContent: 'end', zIndex: 2 }}>\n        <IconButton className=\"style3\" onClick={() => setReorderLayersVisible(false)}>\n          <CloseIcon />\n        </IconButton>\n      </Box>\n      <Box sx={sxClasses.titleBar}>{title}</Box>\n      <DragDropContext onDragEnd={onDragEnd}>\n        <Droppable droppableId=\"droppable\">\n          {(provided) => (\n            <List sx={sxClasses.draggableList} {...provided.droppableProps} innerref={provided.innerRef}>\n              {layerIds.map((layerId, index) => (\n                <Draggable key={layerId} draggableId={layerId} index={index}>\n                  {(providedDrag, snapshotDrag) => (\n                    <ListItem\n                      innerref={providedDrag.innerRef}\n                      sx={snapshotDrag.isDragging ? sxClasses.draggingListItem : sxClasses.regularListItem}\n                      {...providedDrag.draggableProps}\n                      {...providedDrag.dragHandleProps}\n                    >\n                      <ListItemButton>\n                        <ListItemIcon>\n                          <HandleIcon sx={sxClasses.handleIcon} />\n                        </ListItemIcon>\n                        <ListItemText primaryTypographyProps={sxClasses.listItemText} primary={getLayerName(layerId)} />\n                      </ListItemButton>\n                    </ListItem>\n                  )}\n                </Draggable>\n              ))}\n              {provided.placeholder}\n            </List>\n          )}\n        </Droppable>\n      </DragDropContext>\n    </>\n  );\n}\n\nexport default ReorderLayersList;\n","import type React from 'react';\nimport { TypeButtonPanel } from 'geoview-core/src/ui/panel/panel-types';\nimport { TypeJsonObject, toJsonObject } from 'geoview-core/src/core/types/global-types';\nimport { logger } from 'geoview-core/src/core/utils/logger';\n\nimport LayerStepper from './layer-stepper';\nimport ReorderLayersList from './reorder-layers-list';\n\ntype TypePanelContentProps = {\n  buttonPanel: TypeButtonPanel;\n  mapId: string;\n};\n\n/**\n * A react component that displays the details panel content\n *\n * @param {TypePanelContentProps} props the properties of the pane content\n * @returns {JSX.Element} A React JSX Element with the details panel\n */\nfunction PanelContent(props: TypePanelContentProps): JSX.Element {\n  const { mapId, buttonPanel } = props;\n\n  const { cgpv } = window;\n  const { api, ui, react } = cgpv;\n  const { useState, useEffect } = react;\n  const [addLayerVisible, setAddLayerVisible] = useState(false);\n  const [reorderLayersVisible, setReorderLayersVisible] = useState(false);\n  const [mapLayers, setMapLayers] = useState<string[]>([]);\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  const [legend, setLegend] = useState<React.DetailedReactHTMLElement<{}, HTMLElement> | null>();\n  const [actionMenuAnchorElement, setActionMenuAnchorElement] = useState<null | HTMLElement>(null);\n  const [isExpandAll, setExpandAll] = useState<boolean>(false);\n  const [isHideAll, setHideAll] = useState<boolean>(false);\n  const {\n    IconButton,\n    AddIcon,\n    Box,\n    ExpandMoreIcon,\n    ExpandLessIcon,\n    VisibilityIcon,\n    VisibilityOffIcon,\n    Menu,\n    MenuItem,\n    MenuIcon,\n    ListItemIcon,\n    ListItemText,\n    ReorderIcon,\n  } = ui.elements;\n\n  const displayLanguage = api.maps[mapId].getDisplayLanguage();\n\n  const translations: TypeJsonObject = toJsonObject({\n    en: {\n      addLayer: 'Add Layer',\n      expandAll: 'Expand Groups',\n      collapseAll: 'Collapse Groups',\n      showAll: 'Show All',\n      hideAll: 'Hide All',\n      reorderLayers: 'Reorder Layers',\n    },\n    fr: {\n      addLayer: 'Ajouter Couche',\n      expandAll: 'Élargir les groupes',\n      collapseAll: 'Réduire les groupes',\n      showAll: 'Montrer tout',\n      hideAll: 'Cacher tout',\n      reorderLayers: 'Réorganiser les couches',\n    },\n  });\n\n  const sxClasses = {\n    mainContainer: {\n      display: 'flex',\n      flexDirection: 'column',\n      height: 'inherit',\n    },\n    topControls: {\n      display: 'flex',\n      flexDirection: 'row',\n      justifyContent: 'space-between',\n    },\n    addLayerSection: {\n      display: 'flex',\n      alignItems: 'center',\n      marginTop: 'auto',\n      justifyContent: 'end',\n    },\n  };\n\n  const actionMenuOpen = Boolean(actionMenuAnchorElement);\n\n  const updateLayers = () => {\n    // Log\n    logger.logTraceCoreAPIEvent('PANEL-CONTENT - updateLayers');\n\n    if (api.maps[mapId].layer?.layerOrder !== undefined) setMapLayers([...api.maps[mapId].layer.layerOrder].reverse());\n  };\n\n  useEffect(() => {\n    // Log\n    logger.logTraceUseEffect('PANEL-CONTENT - mount 1');\n\n    api.event.on(api.eventNames.MAP.EVENT_MAP_LOADED, updateLayers, mapId);\n    api.event.on(api.eventNames.GET_LEGENDS.LEGEND_LAYERSET_UPDATED, updateLayers, `${mapId}/LegendsLayerSet`);\n\n    return () => {\n      api.event.off(api.eventNames.MAP.EVENT_MAP_LOADED, mapId, updateLayers);\n      api.event.off(api.eventNames.GET_LEGENDS.LEGEND_LAYERSET_UPDATED, mapId, updateLayers);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    // setLegend(api.maps[mapId!].legend.createLegend({ layerIds: mapLayers, isRemoveable: true, canSetOpacity: true, canZoomTo: true }));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [mapLayers]);\n\n  useEffect(() => {\n    // Log\n    logger.logTraceUseEffect('PANEL-CONTENT - mount 2');\n\n    const setAddLayerVisibleListenerFunction = () => {\n      // Log\n      logger.logTraceCoreAPIEvent('PANEL-CONTENT - setAddLayerVisibleListenerFunction');\n\n      setAddLayerVisible(false);\n    };\n\n    api.event.on(api.eventNames.PANEL.EVENT_PANEL_CLOSE, setAddLayerVisibleListenerFunction, `${mapId}/${buttonPanel.buttonPanelId}`);\n    return () => {\n      api.event.off(api.eventNames.PANEL.EVENT_PANEL_CLOSE, `${mapId}/${buttonPanel.buttonPanelId}`, setAddLayerVisibleListenerFunction);\n    };\n  }, [api, buttonPanel.buttonPanelId, mapId]);\n\n  // DEPRECATED, THIS PACKAGE WILL BE REMOVE SOON\n  // TODO: REMOVE\n  useEffect(() => {\n    // setLegend(\n    //   api.maps[mapId!].legend.createLegend({\n    //     layerIds: mapLayers,\n    //     isRemoveable: true,\n    //     canSetOpacity: true,\n    //     expandAll: isExpandAll,\n    //     canZoomTo: true,\n    //   })\n    // );\n    setLegend(null);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isExpandAll]);\n\n  useEffect(() => {\n    // setLegend(\n    //   api.maps[mapId!].legend.createLegend({\n    //     layerIds: mapLayers,\n    //     isRemoveable: true,\n    //     canSetOpacity: true,\n    //     hideAll: isHideAll,\n    //     canZoomTo: true,\n    //   })\n    // );\n    setLegend(null);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isHideAll]);\n\n  const handleShowAddLayer = () => {\n    setAddLayerVisible((state: boolean) => !state);\n  };\n\n  const handleExpandMenuClick = (event: React.MouseEvent<HTMLElement>) => {\n    setActionMenuAnchorElement(event.currentTarget);\n  };\n  const handleCloseMenu = () => {\n    setActionMenuAnchorElement(null);\n  };\n\n  const handleExpandAllClick = (isExpand: boolean) => {\n    setExpandAll(isExpand);\n    handleCloseMenu();\n  };\n\n  const handleShowAllClick = (isShow: boolean) => {\n    setHideAll(!isShow);\n    handleCloseMenu();\n  };\n\n  const handleReorderLayersClick = (isReorder: boolean) => {\n    setReorderLayersVisible(isReorder);\n    handleCloseMenu();\n  };\n\n  useEffect(() => {\n    // this will disable all scrolling when the user is trying to reorder layers\n    // TODO see issue #754 and atlassian/react-beautiful-dnd#460 - there may be a more elegant solution eventually if supported from the react-beautiful-dnd library\n    if (reorderLayersVisible) {\n      const x = window.scrollX;\n      const y = window.scrollY;\n      window.onscroll = () => {\n        window.scrollTo(x, y);\n      };\n    } else {\n      // eslint-disable-next-line @typescript-eslint/no-empty-function\n      window.onscroll = () => {};\n    }\n  }, [reorderLayersVisible]);\n\n  return (\n    <>\n      <Menu anchorEl={actionMenuAnchorElement} open={actionMenuOpen} onClose={handleCloseMenu}>\n        <MenuItem onClick={() => handleExpandAllClick(true)}>\n          <ListItemIcon>\n            <ExpandMoreIcon />\n          </ListItemIcon>\n          <ListItemText>{translations[displayLanguage].expandAll as string}</ListItemText>\n        </MenuItem>\n        <MenuItem onClick={() => handleExpandAllClick(false)}>\n          <ListItemIcon>\n            <ExpandLessIcon />\n          </ListItemIcon>\n          <ListItemText>{translations[displayLanguage].collapseAll as string}</ListItemText>\n        </MenuItem>\n        <MenuItem onClick={() => handleShowAllClick(true)}>\n          <ListItemIcon>\n            <VisibilityIcon />\n          </ListItemIcon>\n          <ListItemText>{translations[displayLanguage].showAll as string}</ListItemText>\n        </MenuItem>\n        <MenuItem onClick={() => handleShowAllClick(false)}>\n          <ListItemIcon>\n            <VisibilityOffIcon />\n          </ListItemIcon>\n          <ListItemText>{translations[displayLanguage].hideAll as string}</ListItemText>\n        </MenuItem>\n        <MenuItem onClick={() => handleReorderLayersClick(true)}>\n          <ListItemIcon>\n            <ReorderIcon />\n          </ListItemIcon>\n          <ListItemText>{translations[displayLanguage].reorderLayers as string}</ListItemText>\n        </MenuItem>\n      </Menu>\n      <Box sx={sxClasses.mainContainer}>\n        {addLayerVisible && <LayerStepper mapId={mapId!} setAddLayerVisible={setAddLayerVisible} />}\n        {reorderLayersVisible && (\n          <ReorderLayersList\n            mapId={mapId!}\n            title={translations[displayLanguage].reorderLayers as string}\n            layerIds={mapLayers}\n            setMapLayers={setMapLayers}\n            setReorderLayersVisible={setReorderLayersVisible}\n          />\n        )}\n        <Box sx={sxClasses.topControls} style={{ display: addLayerVisible || reorderLayersVisible ? 'none' : 'flex' }}>\n          <div>\n            <IconButton color=\"primary\" onClick={handleExpandMenuClick}>\n              <MenuIcon />\n            </IconButton>\n          </div>\n          <Box onClick={handleShowAddLayer}>\n            {translations[displayLanguage].addLayer as string}\n            <IconButton>\n              <AddIcon />\n            </IconButton>\n          </Box>\n        </Box>\n        <div style={{ display: addLayerVisible || reorderLayersVisible ? 'none' : 'block' }}>{legend}</div>\n      </Box>\n    </>\n  );\n}\n\nexport default PanelContent;\n","import { TypeJsonObject, toJsonObject, Cast, AnySchemaObject } from 'geoview-core/src/core/types/global-types';\nimport { TypeIconButtonProps } from 'geoview-core/src/ui/icon-button/icon-button-types';\nimport { AppBarPlugin } from 'geoview-core/src/api/plugin/appbar-plugin';\nimport { LayersOutlinedIcon } from 'geoview-core/src/ui';\nimport { TypePanelProps } from 'geoview-core/src/ui/panel/panel-types';\nimport PanelContent from './panel-content';\nimport schema from '../schema.json';\nimport defaultConfig from '../default-config-layers-panel.json';\n\n/**\n * Create a class for the plugin instance\n */\nclass LayersPanelPlugin extends AppBarPlugin {\n  /**\n   * Return the schema that is defined for this package\n   *\n   * @returns {AnySchemaObject} returns the schema for this package\n   */\n  schema = (): AnySchemaObject => schema;\n\n  /**\n   * Return the default config for this package\n   *\n   * @returns {TypeJsonObject} the default config\n   */\n  defaultConfig = (): TypeJsonObject => toJsonObject(defaultConfig);\n\n  /**\n   * translations object to inject to the viewer translations\n   */\n  translations: TypeJsonObject = toJsonObject({\n    en: {\n      layersPanel: { title: 'Layers' },\n    },\n    fr: {\n      layersPanel: { title: 'Couches' },\n    },\n  });\n\n  onCreateButtonProps(): TypeIconButtonProps {\n    // Button props\n    return {\n      id: 'layersPanelButton',\n      tooltip: 'layersPanel.title',\n      tooltipPlacement: 'right',\n      children: <LayersOutlinedIcon />,\n      visible: true,\n    };\n  }\n\n  onCreateContentProps(): TypePanelProps {\n    // Panel props\n    return {\n      title: 'layersPanel.title',\n      icon: <LayersOutlinedIcon />,\n      width: 350,\n      status: this.configObj?.isOpen?.large as boolean,\n    };\n  }\n\n  onCreateContent(): JSX.Element {\n    return <PanelContent buttonPanel={this.buttonPanel} mapId={this.pluginProps.mapId} />;\n  }\n}\n\nexport default LayersPanelPlugin;\n\n// Keep a reference to the Layers Panel Plugin as part of the geoviewPlugins property stored in the window object\nwindow.geoviewPlugins = window.geoviewPlugins || {};\nwindow.geoviewPlugins['layers-panel'] = Cast<LayersPanelPlugin>(LayersPanelPlugin);\n"],"names":["AbstractPlugin","pluginId","props","_classCallCheck","_defineProperty","this","pluginProps","_createClass","key","value","_this$api","api","maps","mapId","_this$translate","translate","getI18n","language","_this$onAdded","window","cgpv","logger","logInfo","concat","onAdd","onAdded","call","_this$onRemoved","onRemove","onRemoved","AppBarPlugin","_AbstractPlugin","_this","_len","arguments","length","args","Array","_key","_callSuper","_assertThisInitialized","_inherits","MapIcon","ui","elements","id","tooltip","tooltipPlacement","children","react","createElement","visible","_this$configObj","title","icon","width","status","configObj","isOpen","undefined","_this$map","buttonProps","onCreateButtonProps","panelProps","onCreateContentProps","content","onCreateContent","buttonPanel","map","appBarApi","createAppbarPanel","_this$map2","removeAppbarPanel","buttonPanelId","_ref","setAddLayerVisible","displayLanguage","getDisplayLanguage","_api$layerTypes","layerTypes","ESRI_DYNAMIC","ESRI_FEATURE","GEOJSON","GEOPACKAGE","WMS","WFS","OGC_FEATURE","XYZ_TILES","GEOCORE","useState","useRef","_ui$elements","Select","Stepper","TextField","Button","ButtonGroup","Autocomplete","CircularProgressBase","Box","IconButton","CloseIcon","FileUploadIcon","_useState","_useState2","_slicedToArray","activeStep","setActiveStep","_useState3","_useState4","layerURL","setLayerURL","_useState5","_useState6","displayURL","setDisplayURL","_useState7","_useState8","layerType","setLayerType","_useState9","_useState10","layerList","setLayerList","_useState11","_useState12","layerName","setLayerName","_useState13","_useState14","layerEntries","setLayerEntries","_useState15","_useState16","isLoading","setIsLoading","_useState17","_useState18","drag","setDrag","dragPopover","sxClasses","buttonGroup","paddingTop","gap","isMultiple","layerOptions","translations","en","finish","continue","back","or","dropzone","upload","drop","url","layer","stepOne","stepTwo","stepThree","stepFour","service","name","layerSelect","errorEmpty","errorNone","errorFile","errorServer","errorProj","only","fr","esriOptions","type","err","capability","emitErrorEmpty","textField","utilities","showError","emitErrorServer","serviceName","emitErrorProj","proj","supportedProj","message","join","wmsValidation","_ref2","_asyncToGenerator","_regeneratorRuntime","_callee","_urlParams$get","_layerURL$split","_layerURL$split2","baseUrl","queryString","urlParams","paramLayers","wms","layers","hasChildLayers","_context","prev","next","projection","projections","getMapState","currentProjection","getCode","split","URLSearchParams","get","geoUtilities","getWMSServiceMetadata","sent","Capability","Layer","CRS","includes","Error","forEach","childLayer","i","Name","push","Title","layerId","t0","abrupt","stop","apply","wfsValidation","_ref3","_callee2","wfs","_layers","_context2","getWFSServiceMetadata","FeatureTypeList","FeatureType","aFeatureType","ogcFeatureValidation","_ref4","_callee3","keysSingleLayer","responseSingle","jsonSingle","keys","responseCollection","jsonCollection","_layers2","_context3","fetch","json","every","Object","collections","geocoreValidation","indexOf","replaceAll","esriValidation","_ref5","_callee4","esri","_layers3","_context4","getESRIServiceMetadata","capabilities","aLayer","_x","xyzValidation","tiles","dataAccessPath","source","geoJSONValidation","_ref6","_callee5","response","_context5","pop","replace","handleStep2","_ref7","_callee6","valid","_context6","handleStepLast","geoviewLayerId","generateId","event","on","eventNames","LAYER","EVENT_LAYER_ADDED","logTraceCoreAPIEvent","off","getMapServerUrl","_layerURL$split3","layerConfig","geoviewLayerName","geoviewLayerType","metadataAccessPath","listOfLayerEntryConfig","getOGCServerUrl","setTimeout","layerOrder","subLayer","unshift","addGeoviewLayer","handleBack","prevActiveStep","handleFile","file","fileURL","URL","createObjectURL","fileName","handleNameLayer","target","handleDrop","_event$dataTransfer","preventDefault","stopPropagation","dataTransfer","files","upFilename","toUpperCase","endsWith","NavButtons","_ref8","_ref8$isFirst","isFirst","_ref8$isLast","isLast","handleNext","_jsx","sx","padding","_jsxs","variant","onClick","_Fragment","display","justifyContent","zIndex","color","position","top","orientation","steps","stepLabel","stepContent","className","style","onDrop","e","onDragOver","onDragEnter","current","onDragLeave","ref","backgroundColor","bottom","left","right","textAlign","fontSize","onChange","accept","_document$getElementB","document","getElementById","click","label","trim","multiline","layerTokens","parseInt","Number","isNaN","fullWidth","labelId","inputLabel","menuItems","_ref9","_ref10","item","multiple","disableClearable","options","getOptionLabel","option","renderOption","_objectSpread","newValue","x","renderInput","params","layerIds","setReorderLayersVisible","setMapLayers","List","ListItem","ListItemButton","ListItemIcon","HandleIcon","ListItemText","titleBar","draggableList","regularListItem","draggingListItem","background","listItemText","noWrap","handleIcon","margin","getLayerName","geoviewLayers","DragDropContext","onDragEnd","destination","reorderedLayerIds","_toConsumableArray","_reorderedLayerIds$sp","splice","index","removed","moveLayer","Droppable","droppableId","provided","droppableProps","innerref","innerRef","Draggable","draggableId","providedDrag","snapshotDrag","isDragging","draggableProps","dragHandleProps","primaryTypographyProps","primary","placeholder","useEffect","addLayerVisible","reorderLayersVisible","mapLayers","legend","setLegend","actionMenuAnchorElement","setActionMenuAnchorElement","isExpandAll","setExpandAll","isHideAll","setHideAll","AddIcon","ExpandMoreIcon","ExpandLessIcon","VisibilityIcon","VisibilityOffIcon","Menu","MenuItem","MenuIcon","ReorderIcon","toJsonObject","addLayer","expandAll","collapseAll","showAll","hideAll","reorderLayers","mainContainer","flexDirection","height","topControls","addLayerSection","alignItems","marginTop","actionMenuOpen","Boolean","updateLayers","_api$maps$mapId$layer","reverse","logTraceUseEffect","MAP","EVENT_MAP_LOADED","GET_LEGENDS","LEGEND_LAYERSET_UPDATED","setAddLayerVisibleListenerFunction","PANEL","EVENT_PANEL_CLOSE","handleCloseMenu","handleExpandAllClick","isExpand","handleShowAllClick","isShow","scrollX","y","scrollY","onscroll","scrollTo","anchorEl","open","onClose","LayerStepper","ReorderLayersList","currentTarget","state","LayersPanelPlugin","_AppBarPlugin","schema","defaultConfig","layersPanel","LayersOutlinedIcon","large","PanelContent","geoviewPlugins","Cast"],"sourceRoot":""}